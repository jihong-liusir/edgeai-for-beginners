<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "ad0c054ebd3de404d997d1707a513c70",
  "translation_date": "2025-10-11T11:18:08+00:00",
  "source_file": "Module05/04.SLMOps.Deployment.md",
  "language_code": "ta"
}
-->
# рокроХрпБродро┐ 4: ро╡рпЖро│ро┐ропрпАроЯрпБ - родропро╛ро░ро╛роХ роЙро│рпНро│ рооро╛роЯро▓рпН роЪрпЖропро▓рпНрокроЯрпБродрпНродро▓рпН

## роХрогрпНрогрпЛроЯрпНроЯроорпН

роЗроирпНрод ро╡ро┐ро░ро┐ро╡ро╛рой рокропро┐ро▒рпНроЪро┐ропро┐ро▓рпН Foundry Local рокропройрпНрокроЯрпБродрпНродро┐ роиройрпНро▒ро╛роХродрпН родроХрпБроирпНрод рооро╛ро▒ро┐роп рооро╛роЯро▓рпНроХро│рпИ ро╡рпЖро│ро┐ропро┐роЯрпБроорпН роорпБро┤рпБ роЪрпЖропро▓рпНроорпБро▒рпИропрпИ роирпАроЩрпНроХро│рпН роХро▒рпНро▒рпБроХрпНроХрпКро│рпНро╡рпАро░рпНроХро│рпН. рооро╛роЯро▓рпН рооро╛ро▒рпНро▒роорпН, роЕро│ро╡рпАроЯрпНроЯрпБ роорпЗроорпНрокро╛роЯрпБ рооро▒рпНро▒рпБроорпН ро╡рпЖро│ро┐ропрпАроЯрпНроЯрпБ роЕроорпИрокрпНрокрпБроХро│рпИ роЖро░роорпНрокродрпНродро┐ро▓ро┐ро░рпБроирпНродрпБ роорпБроЯро┐ро╡рпБро╡ро░рпИ роХрпИропро╛ро│рпБро╡рпЛроорпН.

## роорпБройрпН родрпЗро╡рпИроХро│рпН

родрпКроЯроЩрпНроХрпБро╡родро▒рпНроХрпБ роорпБройрпН, роЙроЩрпНроХро│ро┐роЯроорпН рокро┐ройрпНро╡ро░рпБроорпН рокрпКро░рпБроЯрпНроХро│рпН роЗро░рпБроХрпНроХ ро╡рпЗрогрпНроЯрпБроорпН:

- тЬЕ ро╡рпЖро│ро┐ропрпАроЯрпНроЯро┐ро▒рпНроХрпБ родропро╛ро░ро╛роХ роЙро│рпНро│ роиройрпНро▒ро╛роХродрпН родроХрпБроирпНрод onnx рооро╛роЯро▓рпН
- тЬЕ Windows роЕро▓рпНро▓родрпБ Mac роХрогро┐ройро┐
- тЬЕ Python 3.10 роЕро▓рпНро▓родрпБ роЕродро▒рпНроХрпБ роорпЗро▓рпН
- тЬЕ роХрпБро▒рпИроирпНродродрпБ 8GB RAM роХро┐роЯрпИроХрпНроХ ро╡рпЗрогрпНроЯрпБроорпН
- тЬЕ роЙроЩрпНроХро│рпН роХрогро┐ройро┐ропро┐ро▓рпН Foundry Local роиро┐ро▒рпБро╡рокрпНрокроЯрпНроЯро┐ро░рпБроХрпНроХ ро╡рпЗрогрпНроЯрпБроорпН

## рокроХрпБродро┐ 1: роЪрпВро┤ро▓рпН роЕроорпИрокрпНрокрпБ

### родрпЗро╡рпИропро╛рой роХро░рпБро╡ро┐роХро│рпИ роиро┐ро▒рпБро╡рпБродро▓рпН

роЙроЩрпНроХро│рпН роЯрпЖро░рпНрооро┐ройро▓рпИ (Windows-ро▓рпН Command Prompt, Mac-ро▓рпН Terminal) родро┐ро▒роирпНродрпБ, рокро┐ройрпНро╡ро░рпБроорпН роХроЯрпНроЯро│рпИроХро│рпИ ро╡ро░ро┐роЪрпИропро╛роХ роЗропроХрпНроХро╡рпБроорпН:

```bash
# Update transformers library to the latest version
pip install transformers -U

# Install Microsoft Olive (model conversion tool)
pip install git+https://github.com/microsoft/Olive.git

# Install ONNX Runtime GenAI
git clone https://github.com/microsoft/onnxruntime-genai
cd onnxruntime-genai && python build.py --config Release
pip install {Your build release path}/onnxruntime_genai-0.9.0.dev0-cp311-cp311-linux_x86_64.whl

# Install additional dependencies
pip install onnx onnxruntime numpy
```

тЪая╕П **роорпБроХрпНроХро┐роп роХрпБро▒ро┐рокрпНрокрпБ**: роирпАроЩрпНроХро│рпН CMake рокродро┐рокрпНрокрпБ 3.31 роЕро▓рпНро▓родрпБ роЕродро▒рпНроХрпБ роорпЗро▓рпН родрпЗро╡рпИрокрпНрокроЯрпБроорпН, роЗродрпБ [cmake.org](https://cmake.org/download/) роЗро▓рпН рокродро┐ро╡ро┐ро▒роХрпНроХроорпН роЪрпЖропрпНропро▓ро╛роорпН.

## рокроХрпБродро┐ 2: рооро╛роЯро▓рпН рооро╛ро▒рпНро▒роорпН рооро▒рпНро▒рпБроорпН роЕро│ро╡рпАроЯрпНроЯрпБ роЪрпЖропро▓рпНрокро╛роЯрпБ

### роЪро░ро┐ропро╛рой ро╡роЯро┐ро╡родрпНродрпИ родрпЗро░рпНро╡рпБ роЪрпЖропрпНродро▓рпН

роЪро┐ро▒ро┐роп роорпКро┤ро┐ рооро╛роЯро▓рпНроХро│рпБроХрпНроХрпБ **ONNX ро╡роЯро┐ро╡роорпН** рокропройрпНрокроЯрпБродрпНрод рокро░ро┐роирпНродрпБро░рпИроХрпНроХрокрпНрокроЯрпБроХро┐ро▒родрпБ, роПройрпЖройро┐ро▓рпН роЗродрпБ:

- ЁЯЪА роЪро┐ро▒роирпНрод роЪрпЖропро▓рпНродро┐ро▒ройрпН роорпЗроорпНрокро╛роЯрпБ
- ЁЯФз ро╣ро╛ро░рпНроЯрпНро╡рпЗро░рпИ роЪро╛ро░ро╛род ро╡рпЖро│ро┐ропрпАроЯрпБ
- ЁЯПн родропро╛ро░ро╛роХ роЙро│рпНро│ родро┐ро▒ройрпНроХро│рпН
- ЁЯУ▒ рокро▓рпНро╡рпЗро▒рпБ родро│роЩрпНроХро│рпБроХрпНроХро╛рой роЗрогроХрпНроХродрпНродройрпНроорпИ

### роорпБро▒рпИ 1: роТро░рпЗ роХроЯрпНроЯро│рпИропро┐ро▓рпН рооро╛ро▒рпНро▒роорпН (рокро░ро┐роирпНродрпБро░рпИроХрпНроХрокрпНрокроЯрпБроХро┐ро▒родрпБ)

роЙроЩрпНроХро│рпН роиройрпНро▒ро╛роХродрпН родроХрпБроирпНрод рооро╛роЯро▓рпИ роирпЗро░роЯро┐ропро╛роХ рооро╛ро▒рпНро▒ рокро┐ройрпНро╡ро░рпБроорпН роХроЯрпНроЯро│рпИропрпИ рокропройрпНрокроЯрпБродрпНродро╡рпБроорпН:

```bash
olive auto-opt \
    --model_name_or_path /path/to/your/finetuned/model \
    --device cpu \
    --provider CPUExecutionProvider \
    --use_model_builder \
    --precision int4 \
    --output_path models/your-model-name/onnx \
    --log_level 1
```

**роЕро│ро╡рпБро░рпБ ро╡ро┐ро│роХрпНроХроорпН:**
- `--model_name_or_path`: роЙроЩрпНроХро│рпН роиройрпНро▒ро╛роХродрпН родроХрпБроирпНрод рооро╛роЯро▓ро┐ройрпН рокро╛родрпИ
- `--device cpu`: CPU-роР роорпЗроорпНрокро╛роЯрпНроЯро┐ро▒рпНроХро╛роХ рокропройрпНрокроЯрпБродрпНродро╡рпБроорпН
- `--precision int4`: INT4 роЕро│ро╡рпАроЯрпНроЯрпИ рокропройрпНрокроЯрпБродрпНродро╡рпБроорпН (роЪрпБрооро╛ро░рпН 75% роЕро│ро╡рпБ роХрпБро▒рпИрокрпНрокрпБ)
- `--output_path`: рооро╛ро▒рпНро▒ро┐роп рооро╛роЯро▓ро┐ройрпН ро╡рпЖро│ро┐ропрпАроЯрпНроЯрпБ рокро╛родрпИ

### роорпБро▒рпИ 2: роХроЯрпНроЯроорпИрокрпНрокрпБ роХрпЛрокрпНрокрпБ роЕрогрпБроХрпБроорпБро▒рпИ (роорпЗроорпНрокроЯрпНроЯ рокропройро░рпНроХро│рпН)

`finetuned_conversion_config.json` роОройрпНро▒ рокрпЖропро░ро┐ро▓рпН роТро░рпБ роХроЯрпНроЯроорпИрокрпНрокрпБ роХрпЛрокрпНрокрпИ роЙро░рпБро╡ро╛роХрпНроХро╡рпБроорпН:

```json
{
    "input_model": {
        "type": "HfModel",
        "model_path": "/path/to/your/finetuned/model",
        "task": "text-generation"
    },
    "systems": {
        "local_system": {
            "type": "LocalSystem",
            "accelerators": [
                {
                    "execution_providers": [
                        "CPUExecutionProvider"
                    ]
                }
            ]
        }
    },
    "passes": {
        "builder": {
            "type": "ModelBuilder",
            "config": {
                "precision": "int4",
                "quantization_config": {
                    "block_size": 128,
                    "is_symmetric": false
                }
            }
        }
    },
    "host": "local_system",
    "target": "local_system",
    "cache_dir": "cache",
    "output_dir": "models/output/your-finetuned-model-onnx"
}
```

рокро┐ройрпНройро░рпН роЗропроХрпНроХро╡рпБроорпН:

```bash
olive run --config ./finetuned_conversion_config.json
```

### роЕро│ро╡рпАроЯрпНроЯрпБ ро╡ро┐ро░рпБрокрпНрокроЩрпНроХро│ро┐ройрпН роТрокрпНрокрпАроЯрпБ

| родрпБро▓рпНро▓ро┐ропроорпН | роХрпЛрокрпНрокрпБ роЕро│ро╡рпБ | роорпБроЯро┐ро╡рпБ ро╡рпЗроХроорпН | рооро╛роЯро▓рпН родро░роорпН | рокро░ро┐роирпНродрпБро░рпИроХрпНроХрокрпНрокроЯрпБроорпН рокропройрпНрокро╛роЯрпБ |
|-----------|-----------|-----------------|---------------|-----------------|
| FP16      | роЕроЯро┐рокрпНрокроЯрпИ ├Ч 0.5 | ро╡рпЗроХрооро╛ройродрпБ | роЪро┐ро▒роирпНродродрпБ | роЙропро░рпН родро░ ро╣ро╛ро░рпНроЯрпНро╡рпЗро░рпБроХрпНроХрпБ |
| INT8      | роЕроЯро┐рокрпНрокроЯрпИ ├Ч 0.25 | рооро┐роХро╡рпБроорпН ро╡рпЗроХрооро╛ройродрпБ | роиро▓рпНро▓родрпБ | роЪроороиро┐ро▓рпИ родрпЗро░рпНро╡рпБ |
| INT4      | роЕроЯро┐рокрпНрокроЯрпИ ├Ч 0.125 | рооро┐роХ ро╡рпЗроХрооро╛ройродрпБ | роПро▒рпНро▒рпБроХрпНроХрпКро│рпНро│роХрпНроХрпВроЯро┐ропродрпБ | ро╡ро│роЩрпНроХро│рпН роХрпБро▒рпИроирпНродродрпБ |

ЁЯТб **рокро░ро┐роирпНродрпБро░рпИ**: роЙроЩрпНроХро│рпН роорпБродро▓рпН ро╡рпЖро│ро┐ропрпАроЯрпНроЯро┐ро▒рпНроХрпБ INT4 роЕро│ро╡рпАроЯрпНроЯрпИродрпН родрпКроЯроЩрпНроХро╡рпБроорпН. родро░роорпН родро┐ро░рпБрокрпНродро┐роХро░рооро╛роХ роЗро▓рпНро▓рпИропрпЖройро┐ро▓рпН, INT8 роЕро▓рпНро▓родрпБ FP16 роорпБропро▒рпНроЪро┐роХрпНроХро╡рпБроорпН.

## рокроХрпБродро┐ 3: Foundry Local ро╡рпЖро│ро┐ропрпАроЯрпНроЯрпБ роЕроорпИрокрпНрокрпБ

### рооро╛роЯро▓рпН роЕроорпИрокрпНрокрпИ роЙро░рпБро╡ро╛роХрпНроХрпБродро▓рпН

Foundry Local рооро╛роЯро▓рпНроХро│ро┐ройрпН роХрпЛрокрпНрокроХродрпНродро┐ро▒рпНроХрпБроЪрпН роЪрпЖро▓рпНро▓ро╡рпБроорпН:

```bash
foundry cache cd ./models/
```

роЙроЩрпНроХро│рпН рооро╛роЯро▓рпН роХрпЛрокрпНрокроХ роЕроорпИрокрпНрокрпИ роЙро░рпБро╡ро╛роХрпНроХро╡рпБроорпН:

```bash
mkdir -p ./models/custom/your-finetuned-model
```

роЙроЩрпНроХро│рпН рооро╛роЯро▓рпН роХрпЛрокрпНрокроХродрпНродро┐ро▓рпН `inference_model.json` роХроЯрпНроЯроорпИрокрпНрокрпБ роХрпЛрокрпНрокрпИ роЙро░рпБро╡ро╛роХрпНроХро╡рпБроорпН:

```json
{
  "Name": "your-finetuned-model-int4",
  "Description": "Fine-tuned quantized model",
  "Version": "1.0",
  "PromptTemplate": {
    "system": "<|im_start|>system\n{Content}<|im_end|>",
    "user": "<|im_start|>user\n{Content}<|im_end|>",
    "assistant": "<|im_start|>assistant\n{Content}<|im_end|>",
    "prompt": "<|im_start|>user\n{Content}<|im_end|>\n<|im_start|>assistant"
  },
  "ModelConfig": {
    "max_length": 2048,
    "temperature": 0.7,
    "top_p": 0.9,
    "repetition_penalty": 1.1
  }
}
```

### рооро╛роЯро▓рпН-роХрпБро▒ро┐рокрпНрокро╛рой роЯрпЖроорпНрокрпНро│рпЗроЯрпН роЕроорпИрокрпНрокрпБроХро│рпН

#### Qwen родрпКроЯро░рпН рооро╛роЯро▓рпНроХро│рпБроХрпНроХрпБ:

```json
{
  "Name": "qwen-finetuned-int4",
  "PromptTemplate": {
    "system": "<|im_start|>system\n{Content}<|im_end|>",
    "user": "<|im_start|>user\n{Content}<|im_end|>",
    "assistant": "<|im_start|>assistant\n{Content}<|im_end|>",
    "prompt": "<|im_start|>user\n{Content}<|im_end|>\n<|im_start|>assistant"
  }
}
```


## рокроХрпБродро┐ 4: рооро╛роЯро▓рпН роЪрпЛродройрпИ рооро▒рпНро▒рпБроорпН роорпЗроорпНрокро╛роЯрпБ

### рооро╛роЯро▓рпН роиро┐ро▒рпБро╡ро▓рпИ роЪро░ро┐рокро╛ро░рпНродрпНродро▓рпН

Foundry Local роЙроЩрпНроХро│рпН рооро╛роЯро▓рпИ роЕроЯрпИропро╛ро│роорпН роХро╛рог роорпБроЯро┐ропрпБрооро╛ роОройрпНрокродрпИроЪрпН роЪро░ро┐рокро╛ро░рпНроХрпНроХро╡рпБроорпН:

```bash
foundry cache ls
```

роирпАроЩрпНроХро│рпН `your-finetuned-model-int4` рокроЯрпНроЯро┐ропро▓ро┐ро▓рпН роХро╛рог ро╡рпЗрогрпНроЯрпБроорпН.

### рооро╛роЯро▓рпН роЪрпЛродройрпИ родрпКроЯроЩрпНроХрпБродро▓рпН

```bash
foundry model run your-finetuned-model-int4
```

### роЪрпЖропро▓рпНродро┐ро▒ройрпН роЕро│ро╡рпАроЯрпБ

роЪрпЛродройрпИропро┐ройрпН рокрпЛродрпБ роорпБроХрпНроХро┐ропрооро╛рой роЕро│ро╡рпБро░рпБроХрпНроХро│рпИ роХрогрпНроХро╛рогро┐роХрпНроХро╡рпБроорпН:

1. **рокродро┐ро▓рпН роирпЗро░роорпН**: роТро╡рпНро╡рпКро░рпБ рокродро┐ро▓рпБроХрпНроХрпБроорпН роЪро░ро╛роЪро░ро┐ роирпЗро░родрпНродрпИ роЕро│ро╡ро┐роЯро╡рпБроорпН
2. **роорпЖрооро░ро┐ рокропройрпНрокро╛роЯрпБ**: RAM рокропройрпНрокро╛роЯрпНроЯрпИ роХрогрпНроХро╛рогро┐роХрпНроХро╡рпБроорпН
3. **CPU рокропройрпНрокро╛роЯрпБ**: роЪрпЖропро▓ро┐ роЪрпБроорпИропрпИроЪрпН роЪро░ро┐рокро╛ро░рпНроХрпНроХро╡рпБроорпН
4. **ро╡рпЖро│ро┐ропрпАроЯрпНроЯрпБ родро░роорпН**: рокродро┐ро▓ро┐ройрпН рокрпКро░рпБродрпНродроорпН рооро▒рпНро▒рпБроорпН родрпЖро│ро┐ро╡рпИ роородро┐рокрпНрокрпАроЯрпБ роЪрпЖропрпНропро╡рпБроорпН

### родро░ роЪро░ро┐рокро╛ро░рпНрокрпНрокрпБ роЪрпЛродройрпИ рокроЯрпНроЯро┐ропро▓рпН

- тЬЕ рооро╛роЯро▓рпН родроХрпБроирпНрод родрпБро▒рпИропро┐ройрпН роХрпЗро│рпНро╡ро┐роХро│рпБроХрпНроХрпБ роЪро░ро┐ропро╛рой рокродро┐ро▓ро│ро┐роХрпНроХро┐ро▒родрпБ
- тЬЕ рокродро┐ро▓рпН ро╡роЯро┐ро╡роорпН роОродро┐ро░рпНрокро╛ро░рпНроХрпНроХрокрпНрокроЯрпБроорпН ро╡рпЖро│ро┐ропрпАроЯрпНроЯрпБ роЕроорпИрокрпНрокрпБроЯройрпН рокрпКро░рпБроирпНродрпБроХро┐ро▒родрпБ
- тЬЕ роирпАрогрпНроЯ роХро╛ро▓ рокропройрпНрокро╛роЯрпНроЯро┐ройрпН рокрпЛродрпБ роорпЖрооро░ро┐ роХроЪро┐ро╡рпБ роЗро▓рпНро▓рпИ
- тЬЕ ро╡рпЖро╡рпНро╡рпЗро▒рпБ роЙро│рпНро│рпАроЯрпНроЯрпБ роирпАро│роЩрпНроХро│ро┐ро▓рпН роиро┐ро▓рпИропро╛рой роЪрпЖропро▓рпНродро┐ро▒ройрпН
- тЬЕ ро╡ро┐ро│ро┐роорпНрокрпБ ро╡ро┤роХрпНроХрпБроХро│рпН рооро▒рпНро▒рпБроорпН родро╡ро▒ро╛рой роЙро│рпНро│рпАроЯрпБроХро│рпИ роЪро░ро┐ропро╛роХ роХрпИропро╛ро│рпБродро▓рпН

## роЪрпБро░рпБроХрпНроХроорпН

ро╡ро╛ро┤рпНродрпНродрпБроХрпНроХро│рпН! роирпАроЩрпНроХро│рпН ро╡рпЖро▒рпНро▒ро┐роХро░рооро╛роХ роорпБроЯро┐родрпНродрпБро│рпНро│рпАро░рпНроХро│рпН:

- тЬЕ роиройрпНро▒ро╛роХродрпН родроХрпБроирпНрод рооро╛роЯро▓рпН ро╡роЯро┐ро╡ рооро╛ро▒рпНро▒роорпН
- тЬЕ рооро╛роЯро▓рпН роЕро│ро╡рпАроЯрпНроЯрпБ роорпЗроорпНрокро╛роЯрпБ
- тЬЕ Foundry Local ро╡рпЖро│ро┐ропрпАроЯрпНроЯрпБ роЕроорпИрокрпНрокрпБ
- тЬЕ роЪрпЖропро▓рпНродро┐ро▒ройрпН роЪрпАро░роорпИрокрпНрокрпБ рооро▒рпНро▒рпБроорпН роЪро┐роХрпНроХро▓рпН родрпАро░рпНро╡рпБ

---

**роХрпБро▒ро┐рокрпНрокрпБ**:  
роЗроирпНрод роЖро╡рогроорпН [Co-op Translator](https://github.com/Azure/co-op-translator) роОройрпНро▒ AI роорпКро┤ро┐рокрпЖропро░рпНрокрпНрокрпБ роЪрпЗро╡рпИропрпИрокрпН рокропройрпНрокроЯрпБродрпНродро┐ роорпКро┤ро┐рокрпЖропро░рпНроХрпНроХрокрпНрокроЯрпНроЯрпБро│рпНро│родрпБ. роиро╛роЩрпНроХро│рпН родрпБро▓рпНро▓ро┐ропродрпНродро┐ро▒рпНроХро╛роХ роорпБропро▒рпНроЪро┐роХрпНроХро┐ройрпНро▒рпЛроорпН, роЖройро╛ро▓рпН родро╛ройро┐ропроЩрпНроХро┐ роорпКро┤ро┐рокрпЖропро░рпНрокрпНрокрпБроХро│ро┐ро▓рпН рокро┐ро┤рпИроХро│рпН роЕро▓рпНро▓родрпБ родро╡ро▒ро╛рой родроХро╡ро▓рпНроХро│рпН роЗро░рпБроХрпНроХроХрпНроХрпВроЯрпБроорпН роОройрпНрокродрпИ роХро╡ройродрпНродро┐ро▓рпН роХрпКро│рпНро│ро╡рпБроорпН. роЕродройрпН родро╛ропрпНроорпКро┤ро┐ропро┐ро▓рпН роЙро│рпНро│ роорпВро▓ роЖро╡рогроорпН роЕродро┐роХро╛ро░рокрпНрокрпВро░рпНро╡ роЖродро╛ро░рооро╛роХроХрпН роХро░рпБродрокрпНрокроЯ ро╡рпЗрогрпНроЯрпБроорпН. роорпБроХрпНроХро┐ропрооро╛рой родроХро╡ро▓рпНроХро│рпБроХрпНроХрпБ, родрпКро┤ро┐ро▓рпНроорпБро▒рпИ рооройро┐род роорпКро┤ро┐рокрпЖропро░рпНрокрпНрокрпБ рокро░ро┐роирпНродрпБро░рпИроХрпНроХрокрпНрокроЯрпБроХро┐ро▒родрпБ. роЗроирпНрод роорпКро┤ро┐рокрпЖропро░рпНрокрпНрокрпИрокрпН рокропройрпНрокроЯрпБродрпНродрпБро╡родро╛ро▓рпН роПро▒рпНрокроЯрпБроорпН роОроирпНрод родро╡ро▒ро╛рой рокрпБро░ро┐родро▓рпНроХро│рпН роЕро▓рпНро▓родрпБ родро╡ро▒ро╛рой ро╡ро┐ро│роХрпНроХроЩрпНроХро│рпБроХрпНроХрпБ роиро╛роЩрпНроХро│рпН рокрпКро▒рпБрокрпНрокро▓рпНро▓.
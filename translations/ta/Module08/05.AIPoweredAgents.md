<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "a534c7d108d29f908a8f9f693d694664",
  "translation_date": "2025-10-11T12:49:21+00:00",
  "source_file": "Module08/05.AIPoweredAgents.md",
  "language_code": "ta"
}
-->
# роЕрооро░рпНро╡рпБ 5: Foundry Local роорпВро▓роорпН AI-роЪроХрпНродро┐ро╡ро╛ропрпНроирпНрод роорпБроХро╡ро░рпНроХро│рпИ ро╡ро┐ро░рпИро╡ро╛роХ роЙро░рпБро╡ро╛роХрпНроХрпБродро▓рпН

роХрпБро▒ро┐рокрпНрокрпБ: Foundry Local роЗро▓рпН роорпБроХро╡ро░рпН родро┐ро▒ройрпНроХро│рпН родрпКроЯро░рпНроирпНродрпБ роорпЗроорпНрокроЯрпБроХро┐ройрпНро▒ройтАФроорпЗроорпНрокроЯрпНроЯ ро╡роЯро┐ро╡роорпИрокрпНрокрпБроХро│рпИ роЪрпЖропро▓рпНрокроЯрпБродрпНродрпБро╡родро▒рпНроХрпБ роорпБройрпН роЪроорпАрокродрпНродро┐роп ро╡рпЖро│ро┐ропрпАроЯрпНроЯрпБ роХрпБро▒ро┐рокрпНрокрпБроХро│ро┐ро▓рпН роЖродро░ро╡рпИ роЙро▒рпБродро┐рокрпНрокроЯрпБродрпНродро╡рпБроорпН.

## роХрогрпНрогрпЛроЯрпНроЯроорпН

Foundry Local-роР рокропройрпНрокроЯрпБродрпНродро┐ роорпБроХро╡ро░рпНроХро│рпБроХрпНроХро╛рой рокропройрпНрокро╛роЯрпБроХро│рпИ ро╡ро┐ро░рпИро╡ро╛роХ роЙро░рпБро╡ро╛роХрпНроХро╡рпБроорпН: роЕроорпИрокрпНрокрпБ роЙродрпНродро░ро╡рпБроХро│рпН, родро░ро╡рпБродрпНродро│роорпН, рооро▒рпНро▒рпБроорпН роТро░рпБроЩрпНроХро┐рогрпИрокрпНрокрпБ ро╡роЯро┐ро╡роЩрпНроХро│рпН. роорпБроХро╡ро░рпН роЖродро░ро╡рпБ роЙро│рпНро│рокрпЛродрпБ, OpenAI-роЗройрпН роЗрогроХрпНроХрооро╛рой роЪрпЖропро▓рпНрокро╛роЯрпНроЯрпБ роЕро┤рпИрокрпНрокрпБроХро│рпИ роорпИропрооро╛роХрпНроХро▓ро╛роорпН роЕро▓рпНро▓родрпБ Azure AI Agents-роР роорпЗроХродрпНродро┐ро▓рпН рокропройрпНрокроЯрпБродрпНродро┐ роХро▓рокрпНрокрпБ ро╡роЯро┐ро╡роорпИрокрпНрокрпБроХро│рпИ роЙро░рпБро╡ро╛роХрпНроХро▓ро╛роорпН.

> **ЁЯФД роиро╡рпАрой SDK-роХрпНроХрпБ рокрпБродрпБрокрпНрокро┐роХрпНроХрокрпНрокроЯрпНроЯродрпБ**: роЗроирпНрод родрпКроХрпБродро┐ Microsoft Foundry-Local repository-роЗройрпН роЪроорпАрокродрпНродро┐роп ро╡роЯро┐ро╡роорпИрокрпНрокрпБроХро│рпБроЯройрпН роЗрогрпИроХрпНроХрокрпНрокроЯрпНроЯрпБро│рпНро│родрпБ рооро▒рпНро▒рпБроорпН `samples/05/` роЗро▓рпН роЙро│рпНро│ роорпБро┤рпБроорпИропро╛рой роЪрпЖропро▓рпНрокро╛роЯрпНроЯрпБроЯройрпН рокрпКро░рпБроирпНродрпБроХро┐ро▒родрпБ. роЙродро╛ро░рогроЩрпНроХро│рпН роЗрокрпНрокрпЛродрпБ роиро╡рпАрой `foundry-local-sdk` рооро▒рпНро▒рпБроорпН `OpenAI` роХро┐ро│рпИропрогрпНроЯрпИ рокропройрпНрокроЯрпБродрпНродрпБроХро┐ройрпНро▒рой, роХрпИропрпЗроЯрпБ роХрпЛро░ро┐роХрпНроХрпИроХро│рпБроХрпНроХрпБ рокродро┐ро▓ро╛роХ.

**ЁЯПЧя╕П роХроЯрпНроЯроорпИрокрпНрокрпБ роЪро┐ро▒рокрпНрокроорпНроЪроЩрпНроХро│рпН:**
- **роЪро┐ро▒рокрпНрокрпБ роорпБроХро╡ро░рпНроХро│рпН**: Retrieval, Reasoning, рооро▒рпНро▒рпБроорпН Execution роорпБроХро╡ро░рпНроХро│рпН родройро┐родрпНродро┐ро▒ройрпНроХро│рпБроЯройрпН
- **роТро┤рпБроЩрпНроХроорпИрокрпНрокрпБ ро╡роЯро┐ро╡роорпН**: рокро▓ роорпБроХро╡ро░рпН рокрогро┐роХро│рпИ рокро┐ройрпНройрпВроЯрпНроЯроХрпН роХрпБро░ро▓рпНроХро│рпБроЯройрпН роТро░рпБроЩрпНроХро┐рогрпИроХрпНроХро┐ро▒родрпБ
- **роиро╡рпАрой SDK роТро░рпБроЩрпНроХро┐рогрпИрокрпНрокрпБ**: `FoundryLocalManager` рооро▒рпНро▒рпБроорпН OpenAI роХро┐ро│рпИропрогрпНроЯрпИ рокропройрпНрокроЯрпБродрпНродрпБроХро┐ро▒родрпБ
- **родропро╛ро░ро┐рокрпНрокрпБ родропро╛ро░ро╛роХ**: рокро┐ро┤рпИ роХрпИропро╛ро│рпБродро▓рпН, роЪрпЖропро▓рпНродро┐ро▒ройрпН роХрогрпНроХро╛рогро┐рокрпНрокрпБ, рооро▒рпНро▒рпБроорпН роЖро░рпЛроХрпНроХро┐роп роЪрпЛродройрпИроХро│рпН роЕроЯроЩрпНроХрпБроорпН
- **роорпБро┤рпБроорпИропро╛рой роЙродро╛ро░рогроЩрпНроХро│рпН**: роорпЗроорпНрокроЯрпНроЯ роЕроорпНроЪроЩрпНроХро│рпБроЯройрпН роЙро│рпНро│ Jupyter роирпЛроЯрпНрокрпБроХрпН

**ЁЯУБ роЙро│рпНро│рпВро░рпН роЪрпЖропро▓рпНрокро╛роЯрпБ:**
- `samples/05/multi_agent_orchestration.ipynb` - родрпКроЯро░рпНрокрпБ роЙродро╛ро░рогроЩрпНроХро│рпН рооро▒рпНро▒рпБроорпН родро░ро╡рпБроХро│рпН
- `samples/05/agents/specialists.py` - роорпБроХро╡ро░рпН роЪрпЖропро▓рпНрокро╛роЯрпБроХро│рпН
- `samples/05/agents/coordinator.py` - роТро░рпБроЩрпНроХро┐рогрпИрокрпНрокрпБ родро╛ро░роХрпИ

роХрпБро▒ро┐рокрпНрокрпБроХро│рпН:
- Foundry Local роЖро╡рогроЩрпНроХро│рпН: https://learn.microsoft.com/en-us/azure/ai-foundry/foundry-local/
- Azure AI Foundry Agents: https://learn.microsoft.com/en-us/azure/ai-services/agents/overview
- роЪрпЖропро▓рпНрокро╛роЯрпНроЯрпБ роЕро┤рпИрокрпНрокрпБ роЙродро╛ро░рогроорпН (Foundry Local роЙродро╛ро░рогроЩрпНроХро│рпН): https://github.com/microsoft/Foundry-Local/tree/main/samples/python/functioncalling

## роХро▒рпНро▒ро▓рпН роирпЛроХрпНроХроЩрпНроХро│рпН
- роироорпНрокроХрооро╛рой роЪрпЖропро▓рпНрокро╛роЯрпНроЯро┐ро▒рпНроХро╛рой роЕроорпИрокрпНрокрпБ роЙродрпНродро░ро╡рпБроХро│рпН рооро▒рпНро▒рпБроорпН родро░ро╡рпБродрпНродро│ роЙродрпНродро┐роХро│рпН ро╡роЯро┐ро╡роорпИроХрпНроХро╡рпБроорпН
- роЪрпЖропро▓рпНрокро╛роЯрпНроЯрпБ роЕро┤рпИрокрпНрокрпБ (роХро░рпБро╡ро┐ рокропройрпНрокро╛роЯрпБ) ро╡роЯро┐ро╡роЩрпНроХро│рпИ роЪрпЖропро▓рпНрокроЯрпБродрпНродро╡рпБроорпН
- рокро▓ роорпБроХро╡ро░рпН рокрогро┐роХро│рпИ роТро░рпБроЩрпНроХро┐рогрпИроХрпНроХро╡рпБроорпН (роЙро│рпНро│рпВро░рпН рооро▒рпНро▒рпБроорпН роХро▓рокрпНрокрпБ)
- роХрогрпНроХро╛рогро┐рокрпНрокрпБ рооро▒рпНро▒рпБроорпН рокро╛родрпБроХро╛рокрпНрокро┐ро▒рпНроХро╛рой родро┐роЯрпНроЯрооро┐роЯро╡рпБроорпН

## рокроХрпБродро┐ 1: роЕроорпИрокрпНрокрпБ роЙродрпНродро░ро╡рпБроХро│рпН рооро▒рпНро▒рпБроорпН родро░ро╡рпБродрпНродро│роорпН

- роХроЯрпБроорпИропро╛рой рокро╛родрпНродро┐ро░роЩрпНроХро│рпН, роХроЯрпНроЯрпБрокрпНрокро╛роЯрпБроХро│рпН, рооро▒рпНро▒рпБроорпН ро╡рпЖро│ро┐ропрпАроЯрпНроЯрпБ ро╡роЯро┐ро╡роЩрпНроХро│рпИ ро╡ро░рпИропро▒рпБроХрпНроХро╡рпБроорпН
- роЙро│рпНро│рпВро░рпН роЕро▓рпНро▓родрпБ роиро┐ро▒рпБро╡рой родро░ро╡рпБроЯройрпН рокродро┐ро▓рпНроХро│рпИ родро░ро╡рпБродрпНродро│рооро╛роХрпНроХро╡рпБроорпН
- JSON ро╡рпЖро│ро┐ропрпАроЯрпБроХро│рпИ роХрпАро┤рпНроороЯрпНроЯ родро╛ройро┐ропроЩрпНроХродрпНродро┐ро▒рпНроХро╛роХ роХроЯрпНроЯро╛ропрооро╛роХрпНроХро╡рпБроорпН

## рокроХрпБродро┐ 2: роЪрпЖропро▓рпНрокро╛роЯрпНроЯрпБ роЕро┤рпИрокрпНрокрпБ (роиро╡рпАрой SDK роЕрогрпБроХрпБроорпБро▒рпИ)

```python
# tools.py
import json
from typing import List, Dict, Any

def get_weather(city: str) -> str:
    return f"Weather in {city}: Sunny, 25C"

# Modern tools format for OpenAI API
TOOLS = [
    {
        "type": "function",
        "function": {
            "name": "get_weather",
            "description": "Get current weather for a city",
            "parameters": {
                "type": "object",
                "properties": {
                    "city": {"type": "string", "description": "City name"}
                },
                "required": ["city"]
            }
        }
    }
]
```

```python
# agent.py
from foundry_local import FoundryLocalManager
from openai import OpenAI
import json
from tools import TOOLS, get_weather

# Initialize Foundry Local Manager
alias = "phi-4-mini"
manager = FoundryLocalManager(alias)

# Create OpenAI client using Foundry Local endpoint
client = OpenAI(
    base_url=manager.endpoint,
    api_key=manager.api_key
)

SYSTEM_PROMPT = "You are a helpful assistant. Use tools when needed."

def process_function_call(messages: List[Dict], tools: List[Dict]) -> str:
    """Process function calling with modern OpenAI API."""
    try:
        response = client.chat.completions.create(
            model=manager.get_model_info(alias).id,
            messages=messages,
            tools=tools,
            tool_choice="auto"
        )
        
        message = response.choices[0].message
        
        if message.tool_calls:
            # Handle function calls
            messages.append(message)
            
            for tool_call in message.tool_calls:
                if tool_call.function.name == "get_weather":
                    args = json.loads(tool_call.function.arguments)
                    result = get_weather(args["city"])
                    
                    # Add function result to messages
                    messages.append({
                        "role": "tool",
                        "tool_call_id": tool_call.id,
                        "content": result
                    })
            
            # Get final response
            final_response = client.chat.completions.create(
                model=manager.get_model_info(alias).id,
                messages=messages
            )
            return final_response.choices[0].message.content
        else:
            return message.content
            
    except Exception as e:
        return f"Error: {str(e)}"

# Example usage
messages = [
    {"role": "system", "content": SYSTEM_PROMPT},
    {"role": "user", "content": "What's the weather in Paris?"}
]

result = process_function_call(messages, TOOLS)
print(result)
```

роЗропроХрпНроХро╡рпБроорпН:
```powershell
# Ensure Foundry Local is running with a model
foundry model run phi-4-mini
python agent.py
```


## рокроХрпБродро┐ 3: рокро▓ роорпБроХро╡ро░рпН роТро░рпБроЩрпНроХро┐рогрпИрокрпНрокрпБ (ро╡роЯро┐ро╡роорпН)

Foundry Local-роЗройрпН OpenAI-роЗройрпН роЗрогроХрпНроХрооро╛рой роорпБроЯро┐ро╡рпБроиро┐ро▓рпИрокрпН рокрпБро│рпНро│ро┐ропрпИрокрпН рокропройрпНрокроЯрпБродрпНродро┐ Retrieval, Reasoning, Execution рокрпЛройрпНро▒ роЪро┐ро▒рокрпНрокрпБ роорпБроХро╡ро░рпНроХро│рпБроХрпНроХрпБ рокрогро┐роХро│рпИ ро╡ро┤ро┐рооро╛ро▒рпНро▒рпБроорпН роТро░рпБроЩрпНроХро┐рогрпИрокрпНрокро╛ро│ро░рпИ ро╡роЯро┐ро╡роорпИроХрпНроХро╡рпБроорпН.

рокроЯро┐ 1) роиро╡рпАрой SDK-ропрпБроЯройрпН роЪро┐ро▒рокрпНрокрпБ роорпБроХро╡ро░рпНроХро│рпИ ро╡ро░рпИропро▒рпБроХрпНроХро╡рпБроорпН (`samples/05/agents/specialists.py` роРрокрпН рокро╛ро░рпНроХрпНроХро╡рпБроорпН)
```python
# agents/specialists.py
from foundry_local import FoundryLocalManager
from openai import OpenAI
from typing import List, Dict, Any

class FoundryClient:
    """Shared client for all specialist agents."""
    
    def __init__(self, model_alias: str = "phi-4-mini"):
        self.client = None
        self.model_name = None
        self.model_alias = model_alias
        self._initialize_client()
    
    def _initialize_client(self):
        """Initialize OpenAI client with Foundry Local."""
        try:
            manager = FoundryLocalManager(self.model_alias)
            model_info = manager.get_model_info(self.model_alias)
            
            self.client = OpenAI(
                base_url=manager.endpoint,
                api_key=manager.api_key
            )
            self.model_name = model_info.id
            print(f"тЬЕ Foundry Local initialized with model: {self.model_name}")
        except Exception as e:
            print(f"тЭМ Error initializing Foundry Local: {e}")
            raise
    
    def chat(self, messages: List[Dict[str, str]], max_tokens: int = 300, temperature: float = 0.4) -> str:
        """Send chat completion request to the model."""
        try:
            response = self.client.chat.completions.create(
                model=self.model_name,
                messages=messages,
                max_tokens=max_tokens,
                temperature=temperature
            )
            return response.choices[0].message.content
        except Exception as e:
            return f"Error generating response: {str(e)}"

# Global client instance
_client = FoundryClient()

class RetrievalAgent:
    """Agent specialized in retrieving relevant information from knowledge sources."""
    
    SYSTEM = """You are a specialized retrieval agent. Your job is to extract and retrieve 
    the most relevant information from knowledge sources based on a given query. Focus on key facts, 
    data points, and contextual information that would be useful for decision-making."""
    
    def run(self, query: str) -> str:
        """Retrieve relevant information based on the query."""
        messages = [
            {"role": "system", "content": self.SYSTEM},
            {"role": "user", "content": f"Query: {query}\n\nRetrieve the most relevant key facts, data points, and contextual information that would help answer this query or support decision-making around it."}
        ]
        return _client.chat(messages)

class ReasoningAgent:
    """Agent specialized in step-by-step analysis and reasoning."""
    
    SYSTEM = """You are a specialized reasoning agent. Your job is to analyze inputs 
    step-by-step and produce structured, logical conclusions. Break down complex problems 
    into manageable parts and provide clear reasoning for your conclusions."""
    
    def run(self, context: str, question: str) -> str:
        """Analyze context and question to produce structured conclusions."""
        messages = [
            {"role": "system", "content": self.SYSTEM},
            {"role": "user", "content": f"Context:\n{context}\n\nQuestion: {question}\n\nAnalyze this step-by-step and provide a structured, logical conclusion with clear reasoning."}
        ]
        return _client.chat(messages, max_tokens=400)

class ExecutionAgent:
    """Agent specialized in creating actionable execution plans."""
    
    SYSTEM = """You are a specialized execution agent. Your job is to transform decisions 
    and conclusions into concrete, actionable steps. Always format your response as valid JSON 
    with an array of action items. Each action should be specific, measurable, and achievable."""
    
    def run(self, decision: str) -> str:
        """Transform decision into actionable steps in JSON format."""
        messages = [
            {"role": "system", "content": self.SYSTEM},
            {"role": "user", "content": f"Decision/Conclusion:\n{decision}\n\nCreate 3-5 specific, actionable steps to implement this decision. Format as JSON with this structure:\n{{\"actions\": [{{\"step\": 1, \"description\": \"...\", \"priority\": \"high/medium/low\", \"timeline\": \"...\"}}]}}"}
        ]
        return _client.chat(messages, max_tokens=400, temperature=0.3)
```

рокроЯро┐ 2) роорпЗроорпНрокроЯрпНроЯ роЕроорпНроЪроЩрпНроХро│рпБроЯройрпН роТро░рпБроЩрпНроХро┐рогрпИрокрпНрокро╛ро│ро░рпИ роЙро░рпБро╡ро╛роХрпНроХро╡рпБроорпН
```python
# agents/coordinator.py
from .specialists import RetrievalAgent, ReasoningAgent, ExecutionAgent
from typing import Dict, Any
import time
import json

class Coordinator:
    """Multi-agent coordinator that orchestrates specialist agents to handle complex tasks."""
    
    def __init__(self):
        """Initialize the coordinator with specialist agents."""
        self.retrieval = RetrievalAgent()
        self.reasoning = ReasoningAgent()
        self.execution = ExecutionAgent()
    
    def handle(self, user_goal: str) -> Dict[str, Any]:
        """
        Orchestrate multiple agents to handle a complex user goal.
        
        Args:
            user_goal: The user's high-level goal or request
            
        Returns:
            Dictionary containing the goal, context, decision, and actions
        """
        print(f"ЁЯОп **Coordinator:** Processing goal: {user_goal}")
        print("=" * 60)
        
        start_time = time.time()
        
        # Step 1: Retrieve relevant context
        print("ЁЯУЪ **Step 1:** Retrieving context...")
        context = self.retrieval.run(user_goal)
        print(f"   тЬЕ Context retrieved ({len(context)} chars)")
        
        # Step 2: Analyze and reason about the context
        print("ЁЯза **Step 2:** Analyzing and reasoning...")
        decision = self.reasoning.run(context, user_goal)
        print(f"   тЬЕ Analysis completed ({len(decision)} chars)")
        
        # Step 3: Create actionable execution plan
        print("тЪб **Step 3:** Creating execution plan...")
        actions = self.execution.run(decision)
        print(f"   тЬЕ Execution plan created ({len(actions)} chars)")
        
        end_time = time.time()
        processing_time = end_time - start_time
        
        result = {
            "goal": user_goal,
            "context": context,
            "decision": decision,
            "actions": actions,
            "agent_flow": ["retrieval", "reasoning", "execution"],
            "processing_time": processing_time,
            "timestamp": time.strftime("%Y-%m-%d %H:%M:%S")
        }
        
        print(f"тЬЕ **Coordination Complete** (тП▒я╕П {processing_time:.2f}s)")
        return result
    
    def handle_with_feedback(self, user_goal: str, feedback_rounds: int = 1) -> Dict[str, Any]:
        """
        Handle a goal with multiple feedback rounds for refinement.
        
        Args:
            user_goal: The user's high-level goal or request
            feedback_rounds: Number of feedback rounds to perform
            
        Returns:
            Dictionary containing the refined result
        """
        result = self.handle(user_goal)
        
        for round_num in range(feedback_rounds):
            print(f"\nЁЯФД **Feedback Round {round_num + 1}:**")
            print("-" * 40)
            
            # Use reasoning agent to refine the execution plan
            refinement_prompt = f"""
            Original Goal: {user_goal}
            Current Decision: {result['decision']}
            Current Actions: {result['actions']}
            
            Review the above and suggest improvements or refinements to make the execution plan more effective.
            """
            
            refined_decision = self.reasoning.run(result['context'], refinement_prompt)
            refined_actions = self.execution.run(refined_decision)
            
            result['decision'] = refined_decision
            result['actions'] = refined_actions
            result['refinement_rounds'] = round_num + 1
            
            print(f"   тЬЕ Round {round_num + 1} refinement completed")
        
        return result

def main():
    """Main function demonstrating the multi-agent coordinator."""
    print("ЁЯдЦ **Multi-Agent Coordinator Demo**")
    print("=" * 50)
    
    # Create coordinator
    coord = Coordinator()
    
    # Example goals
    example_goals = [
        "Create a plan to onboard 5 new customers this month",
        "Develop a strategy to improve team productivity by 20%",
        "Design a customer feedback collection system"
    ]
    
    # Process example with feedback
    goal = example_goals[0]
    print(f"ЁЯОп **Processing Goal:** {goal}")
    print("-" * 50)
    
    try:
        # Basic processing
        result = coord.handle(goal)
        
        # With feedback refinement
        refined_result = coord.handle_with_feedback(goal, feedback_rounds=1)
        
        print("\nЁЯУК **Final Result:**")
        print("=" * 50)
        print(f"**Goal:** {refined_result['goal']}")
        print(f"**Processing Time:** {refined_result['processing_time']:.2f}s")
        
        # Try to parse actions as JSON
        try:
            actions_json = json.loads(refined_result['actions'])
            print(f"\n**Formatted Actions:**")
            print(json.dumps(actions_json, indent=2))
        except (json.JSONDecodeError, TypeError):
            print(f"\n**Actions:** {refined_result['actions']}")
            
    except Exception as e:
        print(f"тЭМ **Error:** {e}")
        print("\nPlease ensure Foundry Local is running with a model loaded.")

if __name__ == "__main__":
    main()
```

рокроЯро┐ 3) Foundry Local-роЗройрпН роорпАродрпБ роЪро░ро┐рокро╛ро░рпНродрпНродрпБ роЙродро╛ро░рогроЩрпНроХро│рпИ роЗропроХрпНроХро╡рпБроорпН
```powershell
REM Confirm the local endpoint and model are available
foundry model list
foundry model run phi-4-mini
curl http://localhost:8000/v1/models

REM Run the coordinator from Module08 directory
cd Module08
python -m samples.05.agents.coordinator

REM Or explore the comprehensive Jupyter notebook
jupyter notebook samples/05/multi_agent_orchestration.ipynb
```


> **ЁЯУЪ роЙро│рпНро│рпВро░рпН роЙродро╛ро░рог роХрпБро▒ро┐рокрпНрокрпБроХро│рпН:**
> - **роорпБроХрпНроХро┐роп роЪрпЖропро▓рпНрокро╛роЯрпБ**: `samples/05/agents/specialists.py` рооро▒рпНро▒рпБроорпН `samples/05/agents/coordinator.py`
> - **роорпБро┤рпБроорпИропро╛рой роЙродро╛ро░рогроЩрпНроХро│рпН**: `samples/05/multi_agent_orchestration.ipynb`
> - **роЕроорпИрокрпНрокрпБ ро╡ро┤ро┐роорпБро▒рпИроХро│рпН**: `samples/05/README.md`
> 
> **ЁЯФЧ родрпКроЯро░рпНрокрпБроЯрпИроп Foundry Local роЙродро╛ро░рогроЩрпНроХро│рпН:**
> - [роЪрпЖропро▓рпНрокро╛роЯрпНроЯрпБ роЕро┤рпИрокрпНрокрпБ роЙродро╛ро░рогроорпН](https://github.com/microsoft/Foundry-Local/tree/main/samples/python/functioncalling)
> - [Hello Foundry Local](https://github.com/microsoft/Foundry-Local/tree/main/samples/python/hello-foundry-local)

ро╡ро┤ро┐роХро╛роЯрпНроЯрпБродро▓рпНроХро│рпН:
- роорпБроХро╡ро░рпНроХро│рпБроХрпНроХрпБ роЗроЯрпИропро┐ро▓рпН роорпАрогрпНроЯрпБроорпН роорпБропро▒рпНроЪро┐роХро│рпН рооро▒рпНро▒рпБроорпН роирпЗро░ роЗроЯрпИро╡рпЖро│ро┐роХро│рпИроЪрпН роЪрпЗро░рпНроХрпНроХро╡рпБроорпН
- роЙро░рпИропро╛роЯро▓рпН/родрпНро░рпЖроЯро┐ройрпН роиро┐ро▓рпИроХрпНроХро╛рой роЪро┐ро▒ро┐роп роиро┐ройрпИро╡роХроХрпН роХроЯрпИ (dict) роЪрпЗро░рпНроХрпНроХро╡рпБроорпН
- рокро▓ роЕро┤рпИрокрпНрокрпБроХро│рпИ роЗрогрпИроХрпНроХрпБроорпН рокрпЛродрпБ ро╡рпАродроХрпН роХроЯрпНроЯрпБрокрпНрокро╛роЯрпНроЯрпИ роЕро▒ро┐роорпБроХрокрпНрокроЯрпБродрпНродро╡рпБроорпН

## рокроХрпБродро┐ 4: роХрогрпНроХро╛рогро┐рокрпНрокрпБ рооро▒рпНро▒рпБроорпН рокро╛родрпБроХро╛рокрпНрокрпБ

роЙроЩрпНроХро│рпН роорпБроХро╡ро░рпН родрпКроХрпБрокрпНрокро┐ро▓рпН родро░ро╡ро┐ройрпН роЪрпБродрпНродродрпНродрпИ роЙро▒рпБродро┐рокрпНрокроЯрпБродрпНродро┐, роЙро│рпНро│рпВро░рпН роЕро│ро╡ро┐ро▓рпН роЙродрпНродро░ро╡рпБроХро│рпН, рокродро┐ро▓рпНроХро│рпН, рооро▒рпНро▒рпБроорпН рокро┐ро┤рпИроХро│рпИ роХрогрпНроХро╛рогро┐роХрпНроХро╡рпБроорпН.

рокроЯро┐ 1) роЗро▓роХрпБро╡ро╛рой роХрпЛро░ро┐роХрпНроХрпИ рокродро┐ро╡рпБ (ро╡ро┐ро░рпБрокрпНрокроорпН)

роХрпБро▒ро┐рокрпНрокрпБ: роХрпАро┤рпЗ роЙро│рпНро│ роЙродро╡ро┐ропро╛ро│ро░рпН роЗропро▓рпНрокро╛роХ роЪрпЗро░рпНроХрпНроХрокрпНрокроЯро╡ро┐ро▓рпНро▓рпИ. роЙро│рпНро│рпВро░рпН JSON рокродро┐ро╡рпБроХрпНроХро╛рой `infra/obs.py` роЙро░рпБро╡ро╛роХрпНроХро╡рпБроорпН.
```python
# infra/obs.py
import time, json, os
from datetime import datetime

LOG_DIR = os.getenv("FOUNDRY_AGENT_LOG_DIR", "./agent_logs")
os.makedirs(LOG_DIR, exist_ok=True)

def log_event(kind: str, payload: dict):
    ts = datetime.utcnow().strftime("%Y%m%dT%H%M%SZ")
    path = os.path.join(LOG_DIR, f"{ts}_{kind}.json")
    with open(path, "w", encoding="utf-8") as f:
        json.dump(payload, f, ensure_ascii=False, indent=2)
```

роорпБроХро╡ро░рпНроХро│ро┐ро▓рпН рокродро┐ро╡рпБроХро│рпИ роТро░рпБроЩрпНроХро┐рогрпИроХрпНроХро╡рпБроорпН (ро╡ро┐ро░рпБрокрпНрокроорпН):
```python
# in agents/specialists.py after receiving content
from infra.obs import log_event
# ... inside chat(...)
resp = r.json()
log_event("chat_request", {"endpoint": f"{BASE_URL}/v1/chat/completions"})
log_event("chat_response", resp)
return resp["choices"][0]["message"]["content"]
```

рокроЯро┐ 2) CLI роорпВро▓роорпН роХро┐роЯрпИроХрпНроХрпБроорпН роиро┐ро▓рпИ рооро▒рпНро▒рпБроорпН роЕроЯро┐рокрпНрокроЯрпИ роЖро░рпЛроХрпНроХро┐ропродрпНродрпИ роЪро░ро┐рокро╛ро░рпНроХрпНроХро╡рпБроорпН
```powershell
REM Ensure Foundry Local is running a model
foundry model list
foundry model run phi-4-mini

REM Validate the OpenAI-compatible endpoint
curl http://localhost:8000/v1/models
```

рокроЯро┐ 3) ро░рпАроЯро╛роХрпНро╖ройрпН рооро▒рпНро▒рпБроорпН PII роЪрпБродрпНродроорпН
- рооро╛роЯро▓рпБроХрпНроХрпБ роЪрпЖропрпНродро┐роХро│рпИ роЕройрпБрокрпНрокрпБро╡родро▒рпНроХрпБ роорпБройрпН, роорпБроХрпНроХро┐ропрооро╛рой рокрпБро▓роЩрпНроХро│рпИ (рооро┐ройрпНройроЮрпНроЪро▓рпНроХро│рпН, родрпКро▓рпИрокрпЗроЪро┐ роОрогрпНроХро│рпН, роРроЯро┐роХро│рпН) роирпАроХрпНроХро╡рпБроорпН роЕро▓рпНро▓родрпБ ро╣ро╛ро╖рпН роЪрпЖропрпНропро╡рпБроорпН
- роорпВро▓ родро░ро╡рпБроХро│рпИ роЪро╛родройродрпНродро┐ро▓рпН ро╡рпИродрпНродро┐ро░рпБроЩрпНроХро│рпН, родрпЗро╡рпИропро╛рой роЪрпВро┤ро▓рпН роЪро░роЯрпБроХро│рпИ роороЯрпНроЯрпБроорпЗ роЕройрпБрокрпНрокро╡рпБроорпН

роЙродро╛ро░рог ро░рпАроЯро╛роХрпНро╖ройрпН роЙродро╡ро┐ропро╛ро│ро░рпН:
```python
# infra/redact.py
import re
EMAIL_RE = re.compile(r"[\w\.-]+@[\w\.-]+")
PHONE_RE = re.compile(r"\+?\d[\d\s\-]{7,}\d")

def sanitize(text: str) -> str:
    text = EMAIL_RE.sub("[REDACTED_EMAIL]", text)
    text = PHONE_RE.sub("[REDACTED_PHONE]", text)
    return text
```

роорпБроХро╡ро░рпНроХро│ро┐ро▓рпН рокропройрпНрокроЯрпБродрпНродро╡рпБроорпН:
```python
from infra.redact import sanitize
# user_goal = sanitize(user_goal)
# context = sanitize(context)
```

рокроЯро┐ 4) роЪрпБро▒рпНро▒рпБ роорпБро▒ро┐роХро│рпН рооро▒рпНро▒рпБроорпН рокро┐ро┤рпИ роХрпИропро╛ро│рпБродро▓рпН
- роТро╡рпНро╡рпКро░рпБ роорпБроХро╡ро░рпН роЕро┤рпИрокрпНрокрпИропрпБроорпН try/except рооро▒рпНро▒рпБроорпН exponential backoff роЙроЯройрпН роЪрпБро▒рпНро▒ро┐ роорпВроЯро╡рпБроорпН
- роорпАрогрпНроЯрпБроорпН роорпАрогрпНроЯрпБроорпН родрпЛро▓рпНро╡ро┐роХро│ро┐ройрпН рокрпЛродрпБ роХрпБро┤ро╛ропрпНроХро│рпИ роХрпБро▒рпБроХро┐роп роЪрпБро▒рпНро▒рпБ роЪрпЖропрпНропро╡рпБроорпН

```python
import time

def with_retry(func, retries=3, base_delay=0.5):
    for i in range(retries):
        try:
            return func()
        except Exception as e:
            if i == retries - 1:
                raise
            time.sleep(base_delay * (2 ** i))
```

рокроЯро┐ 5) роЙро│рпНро│рпВро░рпН роЖроЯро┐роЯрпН родроЯроорпН рооро▒рпНро▒рпБроорпН роПро▒рпНро▒рпБроородро┐
- JSON рокродро┐ро╡рпБроХро│рпИ `./agent_logs` роХрпАро┤рпН роЪрпЗрооро┐роХрпНроХро╡рпБроорпН
- рокродро┐ро╡рпБроХро│рпИ роХро╛ро▓роХроЯрпНроЯрооро╛роХ роЪрпБро░рпБроХрпНроХро┐ роЪрпБро┤ро▒рпНроЪро┐ роЪрпЖропрпНропро╡рпБроорпН
- роородро┐рокрпНрокрпАроЯрпБроХро│рпБроХрпНроХро╛рой роЪрпБро░рпБроХрпНроХроЩрпНроХро│рпИ роПро▒рпНро▒рпБроородро┐ роЪрпЖропрпНропро╡рпБроорпН (роОрогрпНрогро┐роХрпНроХрпИ, роЪро░ро╛роЪро░ро┐ родро╛роородроорпН, рокро┐ро┤рпИ ро╡ро┐роХро┐родроЩрпНроХро│рпН)

рокроЯро┐ 6) Microsoft Learn роЖро╡рогроЩрпНроХро│рпБроЯройрпН роТрокрпНрокро┐роЯро╡рпБроорпН
- Foundry Local OpenAI-роЗройрпН роЗрогроХрпНроХрооро╛рой API-роР ро╡ро┤роЩрпНроХрпБроХро┐ро▒родрпБ (`curl /v1/models` роорпВро▓роорпН роЪро░ро┐рокро╛ро░рпНроХрпНроХрокрпНрокроЯрпНроЯродрпБ)
- `foundry model run <name>` роРрокрпН рокропройрпНрокроЯрпБродрпНродро┐ рооро╛роЯро▓рпН роХро┐роЯрпИрокрпНрокродрпИ роЙро▒рпБродро┐рокрпНрокроЯрпБродрпНродро╡рпБроорпН
- роХро┐ро│рпИропрогрпНроЯрпН роТро░рпБроЩрпНроХро┐рогрпИрокрпНрокрпБ рооро▒рпНро▒рпБроорпН роЙродро╛ро░рог рокропройрпНрокро╛роЯрпБроХро│рпБроХрпНроХро╛рой роЕродро┐роХро╛ро░рокрпНрокрпВро░рпНро╡ ро╡ро┤ро┐роХро╛роЯрпНроЯрпБродро▓рпНроХро│рпИ рокро┐ройрпНрокро▒рпНро▒ро╡рпБроорпН (Open WebUI/роОрокрпНрокроЯро┐ роЪрпЖропрпНро╡родрпБ)

роХрпБро▒ро┐рокрпНрокрпБроХро│рпН
- **Foundry Local роЖро╡рогроЩрпНроХро│рпН**: https://learn.microsoft.com/en-us/azure/ai-foundry/foundry-local/
- **Azure AI Agents**: https://learn.microsoft.com/en-us/azure/ai-services/agents/overview
- **роЙро│рпНро│рпВро░рпН роЙродро╛ро░рогроЩрпНроХро│рпН**:
  - рокро▓ роорпБроХро╡ро░рпН роТро░рпБроЩрпНроХро┐рогрпИрокрпНрокрпБ: `Module08/samples/05/multi_agent_orchestration.ipynb`
  - роорпБроХро╡ро░рпН роЪрпЖропро▓рпНрокро╛роЯрпБ: `Module08/samples/05/agents/`
  - роЙродро╛ро░рог README: `Module08/samples/05/README.md`
- **роЕродро┐роХро╛ро░рокрпНрокрпВро░рпНро╡ Microsoft роЙродро╛ро░рогроЩрпНроХро│рпН**:
  - [роЪрпЖропро▓рпНрокро╛роЯрпНроЯрпБ роЕро┤рпИрокрпНрокрпБ](https://github.com/microsoft/Foundry-Local/tree/main/samples/python/functioncalling)
  - [Hello Foundry Local](https://github.com/microsoft/Foundry-Local/tree/main/samples/python/hello-foundry-local)
  - [Foundry Local Python SDK](https://github.com/microsoft/Foundry-Local/tree/main/sdk/python)
- **роТро░рпБроЩрпНроХро┐рогрпИрокрпНрокрпБ роЙродро╛ро░рогроЩрпНроХро│рпН**: https://learn.microsoft.com/en-us/azure/ai-foundry/foundry-local/how-to/how-to-chat-application-with-open-web-ui

## роЕроЯрпБродрпНрод рокроЯро┐роХро│рпН
- роорпЗроХродрпНродро┐ро▓рпН роТро░рпБроЩрпНроХро┐рогрпИрокрпНрокрпБроХрпНроХро╛рой Azure AI Agents-роР роЖро░ро╛ропро╡рпБроорпН
- роиро┐ро▒рпБро╡рой роЗрогрпИрокрпНрокро┐роХро│рпИроЪрпН роЪрпЗро░рпНроХрпНроХро╡рпБроорпН (Microsoft Graph, родрпЗроЯро▓рпН, родро░ро╡рпБродрпНродро│роЩрпНроХро│рпН)

---

**роХрпБро▒ро┐рокрпНрокрпБ**:  
роЗроирпНрод роЖро╡рогроорпН [Co-op Translator](https://github.com/Azure/co-op-translator) роОройрпНро▒ AI роорпКро┤ро┐рокрпЖропро░рпНрокрпНрокрпБ роЪрпЗро╡рпИропрпИрокрпН рокропройрпНрокроЯрпБродрпНродро┐ роорпКро┤ро┐рокрпЖропро░рпНроХрпНроХрокрпНрокроЯрпНроЯрпБро│рпНро│родрпБ. роиро╛роЩрпНроХро│рпН родрпБро▓рпНро▓ро┐ропродрпНродро┐ро▒рпНроХро╛роХ роорпБропро▒рпНроЪро┐роХрпНроХро┐ройрпНро▒рпЛроорпН, роЖройро╛ро▓рпН родро╛ройро┐ропроЩрпНроХро┐ роорпКро┤ро┐рокрпЖропро░рпНрокрпНрокрпБроХро│ро┐ро▓рпН рокро┐ро┤рпИроХро│рпН роЕро▓рпНро▓родрпБ родро╡ро▒ро╛рой родроХро╡ро▓рпНроХро│рпН роЗро░рпБроХрпНроХроХрпНроХрпВроЯрпБроорпН роОройрпНрокродрпИ роХро╡ройродрпНродро┐ро▓рпН роХрпКро│рпНро│ро╡рпБроорпН. роЕродройрпН родро╛ропрпНроорпКро┤ро┐ропро┐ро▓рпН роЙро│рпНро│ роорпВро▓ роЖро╡рогроорпН роЕродро┐роХро╛ро░рокрпНрокрпВро░рпНро╡ роЖродро╛ро░рооро╛роХ роХро░рпБродрокрпНрокроЯ ро╡рпЗрогрпНроЯрпБроорпН. роорпБроХрпНроХро┐ропрооро╛рой родроХро╡ро▓рпНроХро│рпБроХрпНроХрпБ, родрпКро┤ро┐ро▓рпНроорпБро▒рпИ рооройро┐род роорпКро┤ро┐рокрпЖропро░рпНрокрпНрокрпБ рокро░ро┐роирпНродрпБро░рпИроХрпНроХрокрпНрокроЯрпБроХро┐ро▒родрпБ. роЗроирпНрод роорпКро┤ро┐рокрпЖропро░рпНрокрпНрокрпИрокрпН рокропройрпНрокроЯрпБродрпНродрпБро╡родро╛ро▓рпН роПро▒рпНрокроЯрпБроорпН роОроирпНрод родро╡ро▒ро╛рой рокрпБро░ро┐родро▓рпНроХро│рпН роЕро▓рпНро▓родрпБ родро╡ро▒ро╛рой ро╡ро┐ро│роХрпНроХроЩрпНроХро│рпБроХрпНроХрпБ роиро╛роЩрпНроХро│рпН рокрпКро▒рпБрокрпНрокро▓рпНро▓.
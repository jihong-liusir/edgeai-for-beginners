<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "e88a16101de37838f7cf256a9cd0f199",
  "translation_date": "2025-10-09T21:56:09+00:00",
  "source_file": "Workshop/notebooks/TROUBLESHOOTING.md",
  "language_code": "cs"
}
-->
# Workshop Notebooks - Pr≈Øvodce ≈ôe≈°en√≠m probl√©m≈Ø

## Obsah

- [Bƒõ≈æn√© probl√©my a jejich ≈ôe≈°en√≠](../../../../Workshop/notebooks)
- [Specifick√© probl√©my pro Session 04](../../../../Workshop/notebooks)
- [Specifick√© probl√©my pro Session 05](../../../../Workshop/notebooks)
- [Specifick√© probl√©my pro Session 06](../../../../Workshop/notebooks)
- [Probl√©my specifick√© pro hardware](../../../../Workshop/notebooks)
- [Diagnostick√© p≈ô√≠kazy](../../../../Workshop/notebooks)
- [Jak z√≠skat pomoc](../../../../Workshop/notebooks)

---

## Bƒõ≈æn√© probl√©my a jejich ≈ôe≈°en√≠

### üî¥ CUDA Out of Memory

**Chybov√° zpr√°va:**
```
CUDA failure 2: out of memory
```

**P≈ô√≠ƒçina:** GPU nem√° dostatek VRAM pro naƒçten√≠ modelu.

**≈òe≈°en√≠:**

#### Mo≈ænost 1: Pou≈æijte varianty pro CPU (doporuƒçeno)
```python
# In your notebook, update the CATALOG to use CPU variants
CATALOG = {
    'phi-4-mini-cpu': {'capabilities':['general','summarize'],'priority':2},
    'qwen2.5-0.5b-cpu': {'capabilities':['classification','fast'],'priority':1},
    'phi-3.5-mini-cpu': {'capabilities':['code','refactor'],'priority':3},
}
```

#### Mo≈ænost 2: Pou≈æijte men≈°√≠ modely na GPU
```python
# Use only the smallest model
CATALOG = {
    'qwen2.5-0.5b': {'capabilities':['general','code','summarize','classification'],'priority':1},
}
```

#### Mo≈ænost 3: Vyƒçistƒõte pamƒõ≈• GPU
```bash
# Close other GPU-intensive applications
# Check GPU memory usage
nvidia-smi

# Restart Foundry Local service
foundry service stop
foundry service start
```

#### Mo≈ænost 4: Zvy≈°te pamƒõ≈• GPU (pokud je to mo≈æn√©)
- Zav≈ôete z√°lo≈æky v prohl√≠≈æeƒçi, video editory nebo jin√© aplikace vyu≈æ√≠vaj√≠c√≠ GPU
- Sni≈æte vizu√°ln√≠ efekty Windows
- Pou≈æijte dedikovan√© GPU, pokud m√°te integrovan√© + dedikovan√©

---

### üî¥ APIConnectionError: Connection Error

**Chybov√° zpr√°va:**
```
APIConnectionError: Connection error
[Retry 1/2] Setup failed for 'phi-4-mini': APIConnectionError: Connection error.
```

**P≈ô√≠ƒçina:** Slu≈æba Foundry Local nebƒõ≈æ√≠ nebo nen√≠ dostupn√°.

**≈òe≈°en√≠:**

#### Krok 1: Zkontrolujte stav slu≈æby
```bash
foundry service status
```

#### Krok 2: Spus≈•te slu≈æbu, pokud je zastavena
```bash
foundry service start
```

#### Krok 3: Ovƒõ≈ôte endpoint
```bash
# Check what port the service is using
foundry service status

# Test with curl (adjust port if different)
curl http://localhost:59959/health
curl http://localhost:55769/health
```

#### Krok 4: Naƒçtƒõte po≈æadovan√© modely
```bash
foundry model run phi-4-mini
foundry model run qwen2.5-3b
foundry model run phi-3.5-mini
```

#### Krok 5: Restartujte kernel notebooku
Po spu≈°tƒõn√≠ slu≈æby a naƒçten√≠ model≈Ø restartujte kernel notebooku a znovu spus≈•te v≈°echny bu≈àky.

---

### üî¥ Model Not Found in Catalog

**Chybov√° zpr√°va:**
```
ValueError: Model phi-3.5-mini-cpu not found in the catalog.
[ERROR] Model 'phi-4-mini' not found in the catalog
```

**P≈ô√≠ƒçina:** Model nen√≠ sta≈æen nebo naƒçten v Foundry Local.

**≈òe≈°en√≠:**

#### Mo≈ænost 1: St√°hnƒõte a naƒçtƒõte modely
```bash
# List available models
foundry model ls

# Download the model if not present
foundry model download phi-4-mini
foundry model download qwen2.5-3b
foundry model download phi-3.5-mini

# Load the model into memory
foundry model run phi-4-mini
foundry model run qwen2.5-3b
foundry model run phi-3.5-mini
```

#### Mo≈ænost 2: Pou≈æijte re≈æim automatick√©ho v√Ωbƒõru
Aktualizujte sv≈Øj CATALOG tak, aby pou≈æ√≠val z√°kladn√≠ n√°zvy model≈Ø (bez p≈ô√≠pony `-cpu`):

```python
CATALOG = {
    'phi-4-mini': {'capabilities':['general','summarize'],'priority':2},
    'qwen2.5-0.5b': {'capabilities':['classification','fast'],'priority':1},
    'phi-3.5-mini': {'capabilities':['code','refactor'],'priority':3},
}
```

Foundry Local SDK automaticky vybere nejlep≈°√≠ variantu (CPU, GPU nebo NPU) pro v√°≈° hardware.

---

### üî¥ HttpResponseError: 500 - Failed Loading Model

**Chybov√° zpr√°va:**
```
HttpResponseError: 500 - Failed loading model
```

**P≈ô√≠ƒçina:** Soubor modelu je po≈°kozen nebo nen√≠ kompatibiln√≠ s hardwarem.

**≈òe≈°en√≠:**

#### Znovu st√°hnƒõte model
```bash
# Remove corrupted model
foundry model remove phi-3.5-mini

# Download fresh copy
foundry model download phi-3.5-mini
```

#### Pou≈æijte jinou variantu
```bash
# Try CPU variant instead
foundry model download phi-3.5-mini-cpu
```

---

### üî¥ ImportError: No Module Found

**Chybov√° zpr√°va:**
```
ModuleNotFoundError: No module named 'foundry_local'
```

**P≈ô√≠ƒçina:** Bal√≠ƒçek foundry-local-sdk nen√≠ nainstalov√°n.

**≈òe≈°en√≠:**

```bash
# Install SDK
pip install foundry-local-sdk

# Verify installation
pip show foundry-local-sdk
python -c "from foundry_local import FoundryLocalManager; print('SDK OK')"
```

---

### ÔøΩ Pomalej≈°√≠ prvn√≠ po≈æadavek

**P≈ô√≠znak:** Prvn√≠ dokonƒçen√≠ trv√° v√≠ce ne≈æ 30 sekund, n√°sleduj√≠c√≠ po≈æadavky jsou rychl√©.

**P≈ô√≠ƒçina:** Toto je norm√°ln√≠ chov√°n√≠ - slu≈æba naƒç√≠t√° model do pamƒõti p≈ôi prvn√≠m po≈æadavku.

**≈òe≈°en√≠:**

#### P≈ôedem naƒçtƒõte modely
```bash
# Download and load all models you'll use before running notebooks
foundry model download phi-4-mini
foundry model download qwen2.5-3b
foundry model download phi-3.5-mini

foundry model run phi-4-mini
foundry model run qwen2.5-3b
```

#### Nechte slu≈æbu bƒõ≈æet
```bash
# Start service manually and leave it running
foundry service start
```

---

## Specifick√© probl√©my pro Session 04

### Nespr√°vn√° konfigurace portu

**Probl√©m:** Notebook se p≈ôipojuje k nespr√°vn√©mu portu (55769 vs 59959 vs 57127)

**≈òe≈°en√≠:**

1. Zjistƒõte, kter√Ω port pou≈æ√≠v√° Foundry Local:
```bash
foundry service status
# Note the port number displayed
```

2. Aktualizujte bu≈àku 10 v notebooku:
```python
ENDPOINT = os.getenv('FOUNDRY_LOCAL_ENDPOINT', 'http://localhost:59959/v1')
# Replace 59959 with your actual port
```

3. Restartujte kernel a znovu spus≈•te bu≈àky 6, 8, 10, 12, 16, 20, 22

---

### Nespr√°vn√Ω v√Ωbƒõr modelu

**Probl√©m:** Notebook zobrazuje gpt-oss-20b nebo qwen2.5-7b m√≠sto qwen2.5-3b

**≈òe≈°en√≠:**

1. Restartujte kernel notebooku (vyma≈æe star√Ω stav promƒõnn√Ωch)
2. Znovu spus≈•te bu≈àku 10 (nastaven√≠ alias≈Ø model≈Ø)
3. Znovu spus≈•te bu≈àku 12 (zobrazen√≠ konfigurace)
4. **Ovƒõ≈ôte:** Bu≈àka 12 by mƒõla zobrazit `LLM Model: qwen2.5-3b`

---

### Diagnostick√° bu≈àka selh√°v√°

**Probl√©m:** Bu≈àka 16 zobrazuje "‚ùå Foundry Local service not found!"

**≈òe≈°en√≠:**

1. Ovƒõ≈ôte, ≈æe slu≈æba bƒõ≈æ√≠:
```bash
foundry service status
```

2. Otestujte endpoint ruƒçnƒõ:
```bash
curl http://localhost:59959/v1/models
```

3. Pokud curl funguje, ale notebook ne:
   - Restartujte kernel notebooku
   - Znovu spus≈•te bu≈àky v po≈ôad√≠: 6, 8, 10, 12, 14, 16

4. Pokud curl sel≈æe:
   - Spus≈•te slu≈æbu: `foundry service start`
   - Naƒçtƒõte modely: `foundry model run phi-4-mini` a `foundry model run qwen2.5-3b`

---

### Pre-flight Check selh√°v√°

**Probl√©m:** Bu≈àka 20 zobrazuje chyby p≈ôipojen√≠, i kdy≈æ diagnostika pro≈°la

**≈òe≈°en√≠:**

1. Zkontrolujte, zda jsou modely naƒçteny:
```bash
foundry model ls
# Should show phi-4-mini and qwen2.5-3b
```

2. Pokud modely chyb√≠:
```bash
foundry model run phi-4-mini
foundry model run qwen2.5-3b
```

3. Znovu spus≈•te bu≈àku 20 po naƒçten√≠ model≈Ø

---

### Porovn√°n√≠ selh√°v√° s hodnotami None

**Probl√©m:** Bu≈àka 22 se dokonƒç√≠, ale zobrazuje latenci jako None

**≈òe≈°en√≠:**

1. Zkontrolujte, zda pre-flight pro≈°el (bu≈àka 20)
2. Znovu spus≈•te bu≈àku 22 - modely se mohou p≈ôi prvn√≠m po≈æadavku zah≈ô√≠vat
3. Ovƒõ≈ôte, ≈æe oba modely jsou naƒçteny: `foundry model ls`

---

## Specifick√© probl√©my pro Session 05

### Agent pou≈æ√≠v√° nespr√°vn√Ω model

**Probl√©m:** Agent nepou≈æ√≠v√° oƒçek√°van√Ω model

**≈òe≈°en√≠:**

Ovƒõ≈ôte konfiguraci:
```python
# Check which models are assigned
print(f"Researcher: {researcher.model_id}")
print(f"Editor: {editor.model_id}")
```

Restartujte kernel, pokud jsou modely nespr√°vn√©.

---

### P≈ôeteƒçen√≠ pamƒõ≈•ov√©ho kontextu

**Probl√©m:** Odezvy agenta se postupnƒõ zhor≈°uj√≠

**≈òe≈°en√≠:** Ji≈æ automaticky ≈ôe≈°eno - agenti uchov√°vaj√≠ pouze posledn√≠ch 6 zpr√°v v pamƒõti.

---

## Specifick√© probl√©my pro Session 06

### Zmatek mezi modely CPU a GPU

**Probl√©m:** Zobrazen√≠ chyb CUDA p≈ôi pou≈æit√≠ v√Ωchoz√≠ konfigurace

**≈òe≈°en√≠:** V√Ωchoz√≠ konfigurace nyn√≠ pou≈æ√≠v√° modely pro CPU. Pokud vid√≠te chyby CUDA:

1. Ovƒõ≈ôte, ≈æe pou≈æ√≠v√°te v√Ωchoz√≠ katalog pro CPU:
```python
# Cell should show CPU variants
CATALOG = {
    'phi-4-mini-cpu': {'capabilities':['general','summarize'],'priority':2},
    'qwen2.5-0.5b-cpu': {'capabilities':['classification','fast'],'priority':1},
    'phi-3.5-mini-cpu': {'capabilities':['code','refactor'],'priority':3},
}
```

2. Restartujte kernel a znovu spus≈•te v≈°echny bu≈àky

---

### Detekce z√°mƒõru nefunguje

**Probl√©m:** V√Ωzvy jsou smƒõrov√°ny na nespr√°vn√© modely

**≈òe≈°en√≠:**

Otestujte detekci z√°mƒõru:
```python
# Run the intent detection test cell
for prompt in test_prompts:
    intent = detect_intent(prompt)
    print(f"{prompt[:50]}... ‚Üí {intent}")
```

Aktualizujte RULES, pokud je t≈ôeba upravit vzory.

---

## Probl√©my specifick√© pro hardware

### NVIDIA GPU

**Zkontrolujte stav GPU:**
```bash
nvidia-smi
```

**Bƒõ≈æn√© probl√©my:**
- **Zastaral√Ω ovladaƒç:** Aktualizujte ovladaƒçe NVIDIA
- **Nesoulad verz√≠ CUDA:** P≈ôeinstalujte Foundry Local
- **Fragmentovan√° pamƒõ≈• GPU:** Restartujte syst√©m

### Qualcomm NPU

**Zkontrolujte stav NPU:**
```bash
foundry device info
```

**Bƒõ≈æn√© probl√©my:**
- **Ovladaƒçe NPU nejsou nainstalov√°ny:** Nainstalujte ovladaƒçe Qualcomm NPU
- **Varianta NPU nen√≠ dostupn√°:** Pou≈æijte variantu pro CPU
- **P≈ô√≠li≈° star√° verze Windows:** Aktualizujte na nejnovƒõj≈°√≠ Windows 11

### Syst√©my pouze s CPU

**Doporuƒçen√© modely:**
```python
CATALOG = {
    'qwen2.5-0.5b-cpu': {'capabilities':['classification','fast'],'priority':1},
    'phi-3.5-mini-cpu': {'capabilities':['code','general'],'priority':2},
}
```

**Tipy pro v√Ωkon:**
- Pou≈æ√≠vejte nejmen≈°√≠ modely
- Sni≈æte max_tokens
- Buƒète trpƒõliv√≠ p≈ôi prvn√≠m po≈æadavku

---

## Diagnostick√© p≈ô√≠kazy

### Zkontrolujte v≈°e
```bash
# Service status
foundry service status

# List models
foundry model ls

# Device info
foundry device info

# Version info
foundry --version

# Health check
curl http://localhost:55769/health
```

### V Pythonu
```python
# Check SDK import
try:
    from foundry_local import FoundryLocalManager
    print('‚úì SDK imported')
except ImportError as e:
    print(f'‚úó SDK import failed: {e}')

# Check service connectivity
from openai import OpenAI

try:
    client = OpenAI(base_url='http://localhost:59959/v1', api_key='test')
    models = client.models.list()
    print(f'‚úì Service reachable, {len(list(models.data))} models available')
except Exception as e:
    print(f'‚úó Service not reachable: {e}')
```

---

## Jak z√≠skat pomoc

### 1. Zkontrolujte logy
```bash
# Windows
foundry service logs

# Or check Windows Event Viewer
# Application Logs -> Microsoft-FoundryLocal
```

### 2. GitHub Issues
- Vyhledejte existuj√≠c√≠ probl√©my: https://github.com/microsoft/Foundry-Local/issues
- Vytvo≈ôte nov√Ω probl√©m s:
  - Chybovou zpr√°vou (cel√Ω text)
  - V√Ωstupem `foundry service status`
  - V√Ωstupem `foundry --version`
  - Informacemi o GPU/NPU (nvidia-smi, atd.)
  - Kroky k reprodukci

### 3. Dokumentace
- **Hlavn√≠ repozit√°≈ô:** https://github.com/microsoft/Foundry-Local
- **Python SDK:** https://github.com/microsoft/Foundry-Local/tree/main/sdk/python
- **CLI Reference:** https://github.com/microsoft/Foundry-Local/blob/main/docs/reference/reference-cli.md
- **Troubleshooting:** https://github.com/microsoft/Foundry-Local/blob/main/docs/reference/reference-troubleshooting.md

---

## Kontroln√≠ seznam rychl√Ωch oprav

Kdy≈æ se nƒõco pokaz√≠, zkuste postupnƒõ:

- [ ] Zkontrolujte, zda slu≈æba bƒõ≈æ√≠: `foundry service status`
- [ ] Restartujte slu≈æbu: `foundry service stop && foundry service start`
- [ ] Ovƒõ≈ôte, ≈æe model existuje: `foundry model ls | grep phi-4-mini`
- [ ] Naƒçtƒõte po≈æadovan√© modely: `foundry model run phi-4-mini`
- [ ] Zkontrolujte pamƒõ≈• GPU: `nvidia-smi` (pokud NVIDIA)
- [ ] Vyzkou≈°ejte variantu pro CPU: Pou≈æijte `phi-4-mini-cpu` m√≠sto `phi-4-mini`
- [ ] Restartujte kernel notebooku
- [ ] Vyma≈æte v√Ωstupy notebooku a znovu spus≈•te v≈°echny bu≈àky
- [ ] P≈ôeinstalujte SDK: `pip install --upgrade --force-reinstall foundry-local-sdk`
- [ ] Restartujte syst√©m (posledn√≠ mo≈ænost)

---

## Tipy pro prevenci

### Nejlep≈°√≠ postupy

1. **V≈ædy nejprve zkontrolujte slu≈æbu:**
   ```bash
   foundry service status
   ```

2. **Pou≈æ√≠vejte varianty pro CPU jako v√Ωchoz√≠:**
   ```python
   CATALOG = {
       'phi-4-mini-cpu': {...},
       'qwen2.5-0.5b-cpu': {...},
   }
   ```

3. **P≈ôedem naƒçtƒõte modely p≈ôed spu≈°tƒõn√≠m notebook≈Ø:**
   ```bash
   foundry model run phi-4-mini
   foundry model run qwen2.5-3b
   ```

4. **Nechte slu≈æbu bƒõ≈æet:**
   - Zbyteƒçnƒõ nezastavujte/spou≈°tƒõjte slu≈æbu
   - Nechte ji bƒõ≈æet na pozad√≠ mezi relacemi

5. **Monitorujte zdroje:**
   - Zkontrolujte pamƒõ≈• GPU p≈ôed spu≈°tƒõn√≠m
   - Zav≈ôete nepot≈ôebn√© aplikace vyu≈æ√≠vaj√≠c√≠ GPU
   - Pou≈æijte Spr√°vce √∫loh / nvidia-smi

6. **Pravidelnƒõ aktualizujte:**
   ```bash
   winget upgrade Microsoft.FoundryLocal
   pip install --upgrade foundry-local-sdk
   ```

---

**Posledn√≠ aktualizace:** 8. ≈ô√≠jna 2025

---

**Upozornƒõn√≠**:  
Tento dokument byl p≈ôelo≈æen pomoc√≠ slu≈æby AI pro p≈ôeklad [Co-op Translator](https://github.com/Azure/co-op-translator). I kdy≈æ se sna≈æ√≠me o p≈ôesnost, mƒõjte pros√≠m na pamƒõti, ≈æe automatick√© p≈ôeklady mohou obsahovat chyby nebo nep≈ôesnosti. P≈Øvodn√≠ dokument v jeho p≈Øvodn√≠m jazyce by mƒõl b√Ωt pova≈æov√°n za autoritativn√≠ zdroj. Pro d≈Øle≈æit√© informace se doporuƒçuje profesion√°ln√≠ lidsk√Ω p≈ôeklad. Nejsme zodpovƒõdn√≠ za jak√©koli nedorozumƒõn√≠ nebo nespr√°vn√© interpretace vypl√Ωvaj√≠c√≠ z pou≈æit√≠ tohoto p≈ôekladu.
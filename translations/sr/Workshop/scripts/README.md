<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "8344ea4f8f563cfa921e09247588a225",
  "translation_date": "2025-10-08T14:25:30+00:00",
  "source_file": "Workshop/scripts/README.md",
  "language_code": "sr"
}
-->
# Скрипте за радионицу

Овај директоријум садржи скрипте за аутоматизацију и подршку које се користе за одржавање квалитета и конзистентности материјала радионице.

## Садржај

| Фајл | Сврха |
|------|-------|
| `lint_markdown_cli.py` | Проверава кодне блокове у Markdown-у како би се спречила употреба застарелих Foundry Local CLI команди. |
| `export_benchmark_markdown.py` | Извршава тестирање латенције више модела и генерише извештаје у Markdown и JSON формату. |

## 1. Провера CLI шаблона у Markdown-у

`lint_markdown_cli.py` скенира све `.md` фајлове који нису преводи, тражећи недозвољене Foundry Local CLI шаблоне **унутар ограђених кодних блокова** (``` ... ```). Информативни текст може и даље спомињати застареле команде ради историјског контекста.

### Застарели шаблони (блокирани унутар кодних блокова)

Провера блокира застареле CLI шаблоне. Користите модерне алтернативе.

### Потребне замене
| Застарело | Користити уместо |
|-----------|------------------|
| `foundry model chat <a> "..."` | `foundry model run <a> --prompt "..."` |
| `foundry model list --running` | `foundry model list` |
| `foundry model list --cached` | `foundry cache list` |
| `foundry model stats` | Скрипта за тестирање + системски алати (`Task Manager`, `nvidia-smi`) |
| `foundry model benchmark` | `samples/session03/benchmark_oss_models.py` |
| `foundry model list --available` | `foundry model list` |

### Кодови излаза
| Код | Значење |
|-----|---------|
| 0 | Нема детектованих прекршаја |
| 1 | Један или више застарелих шаблона пронађени |

### Локално покретање
Из коренског директоријума репозиторијума (препоручено):

Windows (PowerShell):
```powershell
python Workshop\scripts\lint_markdown_cli.py --verbose
```

macOS / Linux:
```bash
python Workshop/scripts/lint_markdown_cli.py --verbose
```

### Pre-Commit Hook (опционо)
```bash
echo "python Workshop/scripts/lint_markdown_cli.py" > .git/hooks/pre-commit
chmod +x .git/hooks/pre-commit
```
Ово блокира комитовање које уводи застареле шаблоне.

### CI интеграција
GitHub Action workflow (`.github/workflows/markdown-cli-lint.yml`) покреће проверу при сваком push-у и pull request-у на `main` и `Reactor` гранама. Неуспешни задаци морају бити исправљени пре спајања.

### Додавање нових застарелих шаблона
1. Отворите `lint_markdown_cli.py`.
2. Додајте tuple `(regex, suggestion)` у листу `DEPRECATED`. Користите raw string и укључите `\b` границе речи где је то потребно.
3. Покрените проверу локално да бисте проверили детекцију.
4. Комитујте и пошаљите; CI ће спровести ново правило.

Пример додавања:
```python
DEPRECATED.append((r"\\bfoundry\\s+experimental\\s+foo\\b", "Remove experimental foo usage"))
```

### Дозвола за објашњавање
Пошто се провера односи само на ограђене кодне блокове, можете безбедно описати застареле команде у наративном тексту. Ако *морате* да их прикажете унутар блока ради поређења, додајте блок **без** тројних наводника (нпр. увлачење или цитат) или их препишите у псеудо-форму.

### Прескакање одређених фајлова (напредно)
Ако је потребно, ставите примере у засебан фајл ван репозиторијума или промените екстензију док радите на њему. Намерно прескакање за преведене копије је аутоматско (путање које садрже `translations`).

### Решавање проблема
| Проблем | Узрок | Решење |
|---------|-------|--------|
| Провера означава линију коју сте ажурирали | Regex је превише широк | Сузите шаблон додавањем додатне границе речи (`\b`) или сидра |
| CI не успева, али локално пролази | Различита верзија Python-а или непријављене промене | Поново покрените локално, уверите се да је радно окружење чисто, проверите верзију Python-а у workflow-у (3.11) |
| Потребно је привремено заобићи | Хитна исправка | Одмах примените исправку; размислите о коришћењу привремене гране и накнадног PR-а (избегавајте додавање прекидача за заобилажење) |

### Разлог
Одржавање документације у складу са *тренутним* стабилним CLI интерфејсом спречава проблеме на радионици, избегава конфузију код учесника и централизује мерење перформанси кроз одржаване Python скрипте уместо CLI подкоманди које се мењају.

---
Одржава се као део алатки за квалитет радионице. За побољшања (нпр. аутоматско исправљање предлога или генерисање HTML извештаја), отворите питање или пошаљите PR.

## 2. Скрипта за валидацију примера

`validate_samples.py` проверава све Python примерке за синтаксу, увоз и усклађеност са најбољим праксама.

### Употреба
```bash
# Validate all samples
python scripts/validate_samples.py

# Validate specific session
python scripts/validate_samples.py --session 01

# Verbose mode (includes best practice warnings)
python scripts/validate_samples.py --verbose

# Summary only
python scripts/validate_samples.py --summary
```

### Шта проверава
- ✅ Ваљаност Python синтаксе
- ✅ Присуство потребних увоза
- ✅ Имплементација обраде грешака (verbose режим)
- ✅ Коришћење типских назнака (verbose режим)
- ✅ Документоване функције (verbose режим)
- ✅ Линкове ка SDK референцама (verbose режим)

### Енвиронмент променљиве
- `SKIP_IMPORT_CHECK=1` - Прескаче проверу увоза
- `SKIP_SYNTAX_CHECK=1` - Прескаче проверу синтаксе

### Кодови излаза
- `0` - Сви примери су прошли валидацију
- `1` - Један или више примера нису прошли

## 3. Скрипта за тестирање примера

`test_samples.py` извршава тестове на свим примерима како би се проверило да ли се извршавају без грешака.

### Употреба
```bash
# Test all samples
python scripts/test_samples.py

# Test specific session
python scripts/test_samples.py --session 01

# Quick mode (shorter timeouts)
python scripts/test_samples.py --quick

# Verbose mode (show output)
python scripts/test_samples.py --verbose
```

### Предуслови
- Foundry Local сервис покренут: `foundry service start`
- Модели учитани: `foundry model run phi-4-mini`
- Инсталиране зависности: `pip install -r requirements.txt`

### Шта тестира
- ✅ Пример се може извршити без грешака у раду
- ✅ Генерише потребни излаз
- ✅ Правилно обрађује грешке у случају неуспеха
- ✅ Перформансе (време извршења)

### Енвиронмент променљиве
- `FOUNDRY_LOCAL_ALIAS=phi-4-mini` - Модел који се користи за тестирање
- `TEST_TIMEOUT=30` - Време за извршење по примеру у секундама

### Очекивани неуспеси
Неки тестови могу да не успеју ако опционалне зависности нису инсталиране (нпр. `ragas`, `sentence-transformers`). Инсталирајте са:
```bash
pip install sentence-transformers ragas datasets
```

### Кодови излаза
- `0` - Сви тестови су прошли
- `1` - Један или више тестова нису прошли

## 4. Експортер за Benchmark Markdown

Скрипта: `export_benchmark_markdown.py`

Генерише репродуктивну табелу перформанси за сет модела.

### Употреба
```powershell
python Workshop\scripts\export_benchmark_markdown.py --models "qwen2.5-0.5b,gemma-2-2b" --prompt "Explain retrieval augmented generation briefly." --rounds 3 --output benchmark_report.md
```

### Излази
| Фајл | Опис |
|------|------|
| `benchmark_report.md` | Markdown табела (просек, p95, токени/секунда, опционално први токен) |
| `benchmark_report.json` | Сирови низ метрика за поређење и историју |

### Опције
| Ознака | Опис | Подразумевано |
|--------|------|---------------|
| `--models` | Алијаси модела, одвојени зарезом | (обавезно) |
| `--prompt` | Подстицај коришћен у сваком кругу | (обавезно) |
| `--rounds` | Број кругова по моделу | 3 |
| `--output` | Markdown излазни фајл | `benchmark_report.md` |
| `--json` | JSON излазни фајл | `benchmark_report.json` |
| `--fail-on-empty` | Ненулти излаз ако сви тестови не успеју | искључено |

Енвиронмент променљива `BENCH_STREAM=1` додаје мерење латенције првог токена.

### Напомене
- Поново користи `workshop_utils` за конзистентно покретање модела и кеширање.
- Ако се покреће из другог радног директоријума, скрипта покушава да пронађе алтернативне путање за лоцирање `workshop_utils`.
- За поређење GPU-а: покрените једном, омогућите убрзање преко CLI конфигурације, поново покрените и упоредите JSON.

---

**Одрицање од одговорности**:  
Овај документ је преведен коришћењем услуге за превођење вештачке интелигенције [Co-op Translator](https://github.com/Azure/co-op-translator). Иако се трудимо да обезбедимо тачност, молимо вас да имате у виду да аутоматски преводи могу садржати грешке или нетачности. Оригинални документ на његовом изворном језику треба сматрати ауторитативним извором. За критичне информације препоручује се професионални превод од стране људи. Не сносимо одговорност за било каква погрешна тумачења или неспоразуме који могу произаћи из коришћења овог превода.
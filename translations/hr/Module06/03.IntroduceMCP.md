<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "b6bd5b920b610665fd0462f6b5c2e134",
  "translation_date": "2025-09-18T23:53:05+00:00",
  "source_file": "Module06/03.IntroduceMCP.md",
  "language_code": "hr"
}
-->
# Sekcija 03 - Integracija Model Context Protocol (MCP)

## Uvod u MCP (Model Context Protocol)

Model Context Protocol (MCP) je revolucionarni okvir koji omogućuje jezičnim modelima interakciju s vanjskim alatima i sustavima na standardiziran način. Za razliku od tradicionalnih pristupa gdje su modeli izolirani, MCP stvara most između AI modela i stvarnog svijeta putem jasno definiranog protokola.

### Što je MCP?

MCP služi kao komunikacijski protokol koji omogućuje jezičnim modelima:
- Povezivanje s vanjskim izvorima podataka
- Izvršavanje alata i funkcija
- Interakciju s API-ima i uslugama
- Pristup informacijama u stvarnom vremenu
- Izvođenje složenih operacija u više koraka

Ovaj protokol transformira statične jezične modele u dinamične agente sposobne za obavljanje praktičnih zadataka izvan generiranja teksta.

## Mali jezični modeli (SLM) u MCP-u

Mali jezični modeli predstavljaju učinkovit pristup implementaciji AI-a, nudeći nekoliko prednosti:

### Prednosti SLM-ova
- **Učinkovitost resursa**: Niži zahtjevi za računalnim resursima
- **Brže vrijeme odziva**: Smanjena latencija za aplikacije u stvarnom vremenu  
- **Isplativost**: Minimalne infrastrukturne potrebe
- **Privatnost**: Mogućnost lokalnog rada bez prijenosa podataka
- **Prilagodljivost**: Lakše prilagođavanje specifičnim domenama

### Zašto SLM-ovi dobro funkcioniraju s MCP-om

SLM-ovi u kombinaciji s MCP-om stvaraju moćnu kombinaciju gdje se sposobnosti zaključivanja modela nadopunjuju vanjskim alatima, kompenzirajući manji broj parametara kroz poboljšanu funkcionalnost.

## Pregled Python MCP SDK-a

Python MCP SDK pruža temelj za izgradnju aplikacija koje podržavaju MCP. SDK uključuje:

- **Klijentske biblioteke**: Za povezivanje s MCP poslužiteljima
- **Okvir za poslužitelje**: Za kreiranje prilagođenih MCP poslužitelja
- **Upravitelje protokola**: Za upravljanje komunikacijom
- **Integraciju alata**: Za izvršavanje vanjskih funkcija

## Praktična implementacija: Phi-4 MCP klijent

Pogledajmo implementaciju u stvarnom svijetu koristeći Microsoftov Phi-4 mini model integriran s MCP mogućnostima.

### Arhitektura sustava

Implementacija slijedi slojevitu arhitekturu:

```
┌─────────────────────────────────────┐
│        Application Layer           │
│  ├── Interactive Loop              │
│  ├── CLI Interface                 │
│  └── Configuration Management      │
└─────────────────────────────────────┘
┌─────────────────────────────────────┐
│         LLM Client Layer           │
│  ├── OllamaClient                  │
│  ├── VLLMClient                    │
│  └── LLMClient (Abstract)          │
└─────────────────────────────────────┘
┌─────────────────────────────────────┐
│        MCP Client Layer            │
│  ├── Phi4MiniMCPClient (STDIO)     │
│  ├── Phi4MiniSSEMCPClient (SSE)    │
│  └── BaseMCPClient (Abstract)      │
└─────────────────────────────────────┘
┌─────────────────────────────────────┐
│      Tool Processing Layer         │
│  ├── ToolCallHandler               │
│  ├── Function Format Transformer   │
│  └── Tool Schema Management        │
└─────────────────────────────────────┘
```

### Ključne komponente

#### 1. MCP klijentske klase

**BaseMCPClient**: Apstraktni temelj koji pruža zajedničku funkcionalnost
- Asinkroni protokol upravitelja konteksta
- Standardna definicija sučelja
- Upravljanje resursima

**Phi4MiniMCPClient**: Implementacija temeljena na STDIO
- Lokalna komunikacija procesa
- Upravljanje standardnim ulazom/izlazom
- Upravljanje podprocesima

**Phi4MiniSSEMCPClient**: Implementacija Server-Sent Events
- HTTP komunikacija putem streaminga
- Upravljanje događajima u stvarnom vremenu
- Povezivanje s web poslužiteljima

#### 2. Integracija LLM-a

**OllamaClient**: Lokalno hostiranje modela
```python
class OllamaClient(LLMClient):
    def __init__(self):
        self.url = "http://localhost:11434/api/chat"
        self.model_id = "phi4-mini:3.8b-fp16"
```

**VLLMClient**: Visokoučinkovito posluživanje
```python
class VLLMClient(LLMClient):
    def __init__(self):
        self.url = "http://localhost:8000/v1"
        self.model_id = "microsoft/Phi-4-mini-instruct"
```

#### 3. Cjevovod za obradu alata

Cjevovod za obradu alata transformira MCP alate u formate kompatibilne s jezičnim modelima:

```python
def transform_functions_format(input_data):
    """Convert MCP tool schemas to LLM-compatible formats"""
    # Maps OpenAPI schemas to function calling schemas
    # Handles parameter type conversion
    # Maintains required field information
```

## Početak rada: Vodič korak po korak

### Korak 1: Postavljanje okruženja

Instalirajte potrebne ovisnosti:
```bash
pip install fastmcp mcp-python-client openai requests pyautogui Pillow
```

### Korak 2: Osnovna konfiguracija

Postavite varijable okruženja:
```python
# System Configuration
SYSTEM_PROMPT = "You are an AI assistant with some tools."

# Ollama Configuration (Local)
OLLAMA_URL = "http://localhost:11434/api/chat"
OLLAMA_MODEL_ID = "phi4-mini:3.8b-fp16"

# vLLM Configuration (Server)
VLLM_URL = "http://localhost:8000/v1"
VLLM_MODEL_ID = "microsoft/Phi-4-mini-instruct"
```

### Korak 3: Pokretanje vašeg prvog MCP klijenta

**Osnovno postavljanje Ollama:**
```bash
python ghmodel_mcp_demo.py
```

**Korištenje vLLM pozadinskog sustava:**
```bash
python ghmodel_mcp_demo.py --env vllm
```

**Povezivanje putem Server-Sent Events:**
```bash
python ghmodel_mcp_demo.py --run sse
```

**Prilagođeni MCP poslužitelj:**
```bash
python ghmodel_mcp_demo.py --server /path/to/server.py
```

### Korak 4: Programska upotreba

```python
import asyncio
from ghmodel_mcp_demo import OllamaClient, Phi4MiniMCPClient

async def automated_interaction():
    # Configure MCP server parameters
    server_params = StdioServerParameters(
        command="npx",
        args=["@playwright/mcp@latest"],
        env=None,
    )
    
    # Create MCP client and process tools
    async with Phi4MiniMCPClient(server_params) as mcp_client:
        tools = await process_mcp_tools(mcp_client)
        llm_client = OllamaClient()
        
        # Generate response with tool capabilities
        response, messages = await llm_client.generate_response(
            "Help me automate a web task",
            tools
        )
        return response

# Execute the automation
result = asyncio.run(automated_interaction())
print(result)
```

## Napredne značajke

### Podrška za više pozadinskih sustava

Implementacija podržava Ollama i vLLM pozadinske sustave, omogućujući izbor prema vašim potrebama:

- **Ollama**: Bolje za lokalni razvoj i testiranje
- **vLLM**: Optimizirano za produkciju i scenarije visokog prometa

### Fleksibilni protokoli povezivanja

Podržana su dva načina povezivanja:

**STDIO način**: Direktna komunikacija procesa
- Niža latencija
- Pogodno za lokalne alate
- Jednostavno postavljanje

**SSE način**: Streaming putem HTTP-a
- Mogućnost rada na mreži
- Bolje za distribuirane sustave
- Ažuriranja u stvarnom vremenu

### Mogućnosti integracije alata

Sustav može integrirati razne alate:
- Web automatizacija (Playwright)
- Operacije s datotekama
- Interakcije s API-ima
- Sistemske naredbe
- Prilagođene funkcije

## Upravljanje greškama i najbolje prakse

### Sveobuhvatno upravljanje greškama

Implementacija uključuje robusno upravljanje greškama za:

**Greške povezivanja:**
- Neuspjesi MCP poslužitelja
- Istek vremena mreže
- Problemi s povezivanjem

**Greške izvršavanja alata:**
- Nedostajući alati
- Validacija parametara
- Neuspjesi izvršavanja

**Greške obrade odgovora:**
- Problemi s parsiranjem JSON-a
- Nedosljednosti formata
- Anomalije u odgovorima LLM-a

### Najbolje prakse

1. **Upravljanje resursima**: Koristite asinkrone upravitelje konteksta
2. **Upravljanje greškama**: Implementirajte sveobuhvatne try-catch blokove
3. **Logiranje**: Omogućite odgovarajuće razine logiranja
4. **Sigurnost**: Validirajte ulaze i sanitizirajte izlaze
5. **Performanse**: Koristite pooling povezivanja i caching

## Primjene u stvarnom svijetu

### Web automatizacija
```python
# Example: Automated web testing
async def web_automation_example():
    tools = await setup_playwright_tools()
    response = await llm_client.generate_response(
        "Navigate to example.com and take a screenshot",
        tools
    )
```

### Obrada podataka
```python
# Example: File analysis
async def data_processing_example():
    tools = await setup_file_tools()
    response = await llm_client.generate_response(
        "Analyze the CSV file and generate a summary report",
        tools
    )
```

### Integracija API-ja
```python
# Example: API interactions
async def api_integration_example():
    tools = await setup_api_tools()
    response = await llm_client.generate_response(
        "Fetch weather data and create a forecast summary",
        tools
    )
```

## Optimizacija performansi

### Upravljanje memorijom
- Učinkovito upravljanje poviješću poruka
- Pravilno čišćenje resursa
- Pooling povezivanja

### Optimizacija mreže
- Asinkrone HTTP operacije
- Konfigurabilni timeouts
- Graciozno oporavljanje od grešaka

### Paralelna obrada
- Neblokirajući I/O
- Paralelno izvršavanje alata
- Učinkoviti asinkroni obrasci

## Sigurnosni aspekti

### Zaštita podataka
- Sigurno upravljanje API ključevima
- Validacija ulaza
- Sanitizacija izlaza

### Sigurnost mreže
- Podrška za HTTPS
- Zadane lokalne krajnje točke
- Sigurno upravljanje tokenima

### Sigurnost izvršavanja
- Filtriranje alata
- Okruženja u sandboxu
- Logiranje revizija

## Zaključak

SLM-ovi integrirani s MCP-om predstavljaju promjenu paradigme u razvoju AI aplikacija. Kombiniranjem učinkovitosti malih modela s moći vanjskih alata, programeri mogu kreirati inteligentne sustave koji su i resursno učinkoviti i vrlo sposobni.

Implementacija Phi-4 MCP klijenta pokazuje kako se ova integracija može postići u praksi, pružajući čvrst temelj za izgradnju sofisticiranih aplikacija pogonjenih AI-jem.

Ključne točke:
- MCP povezuje jezične modele s vanjskim sustavima
- SLM-ovi nude učinkovitost bez gubitka sposobnosti kada se nadopune alatima
- Modularna arhitektura omogućuje jednostavno proširenje i prilagodbu
- Pravilno upravljanje greškama i sigurnosne mjere ključni su za produkcijsku upotrebu

Ovaj vodič pruža temelj za izgradnju vlastitih aplikacija koje koriste SLM-ove i MCP, otvarajući mogućnosti za automatizaciju, obradu podataka i integraciju inteligentnih sustava.

---

**Odricanje od odgovornosti**:  
Ovaj dokument je preveden pomoću AI usluge za prevođenje [Co-op Translator](https://github.com/Azure/co-op-translator). Iako nastojimo osigurati točnost, imajte na umu da automatski prijevodi mogu sadržavati pogreške ili netočnosti. Izvorni dokument na izvornom jeziku treba smatrati autoritativnim izvorom. Za ključne informacije preporučuje se profesionalni prijevod od strane ljudskog prevoditelja. Ne preuzimamo odgovornost za bilo kakve nesporazume ili pogrešne interpretacije koje proizlaze iz korištenja ovog prijevoda.